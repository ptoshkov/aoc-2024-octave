global ROWS;
global COLUMNS;

ROWS = 7;
COLUMNS = 11;
positions = [
0,4;
6,3;
10,3;
2,0;
0,0;
3,0;
7,6;
3,0;
9,3;
7,3;
2,4;
9,5
];
positions+=1;
velocities = [
3,-3;
-1,-3;
-1,2;
2,-1;
1,3;
-2,-2;
-1,-3;
-1,-2;
2,3;
-1,2;
2,-3;
-3,-3
];

ROWS = 103;
COLUMNS = 101;
positions = [
44,70;
56,4;
6,30;
64,4;
57,22;
5,22;
2,48;
80,54;
76,0;
7,89;
25,30;
92,41;
39,6;
30,82;
8,67;
87,24;
83,33;
95,59;
10,69;
15,15;
73,21;
11,22;
87,95;
26,47;
50,58;
88,60;
82,15;
47,83;
96,92;
1,30;
21,51;
49,18;
52,0;
46,30;
13,17;
72,85;
99,57;
96,26;
79,31;
0,80;
19,89;
13,85;
34,51;
67,96;
75,1;
30,54;
95,66;
19,77;
32,29;
52,73;
82,84;
74,88;
47,18;
98,71;
28,70;
91,42;
54,101;
33,77;
0,64;
56,63;
43,88;
31,67;
72,26;
52,6;
41,67;
15,18;
73,60;
20,54;
66,41;
80,0;
83,41;
59,0;
92,20;
85,102;
24,20;
99,52;
40,54;
86,53;
69,43;
81,95;
55,76;
93,68;
52,6;
76,22;
7,93;
83,12;
42,100;
47,22;
85,7;
39,5;
26,38;
95,34;
67,78;
51,52;
14,91;
22,83;
26,38;
84,76;
15,42;
68,32;
40,39;
35,87;
32,81;
66,71;
1,59;
99,60;
66,29;
13,18;
27,39;
21,96;
49,30;
36,51;
38,6;
4,79;
1,1;
28,46;
79,38;
24,84;
55,23;
55,7;
37,34;
62,70;
99,84;
75,83;
15,41;
73,99;
65,3;
17,30;
4,73;
13,41;
49,47;
92,82;
67,27;
49,52;
73,83;
8,89;
97,43;
59,30;
4,43;
36,78;
9,79;
36,97;
62,15;
50,2;
95,10;
63,69;
0,96;
44,74;
100,77;
29,0;
58,63;
48,7;
2,71;
67,26;
76,50;
68,0;
4,45;
23,94;
41,26;
36,52;
33,96;
61,25;
86,52;
7,43;
52,17;
27,84;
12,54;
5,37;
8,51;
97,30;
68,8;
93,79;
55,14;
9,65;
4,81;
99,81;
18,30;
34,102;
96,42;
25,46;
56,44;
66,8;
36,87;
64,9;
1,49;
38,59;
41,102;
19,87;
30,75;
67,83;
68,3;
43,49;
8,99;
42,58;
70,35;
34,32;
19,9;
1,52;
41,57;
32,97;
57,19;
83,15;
1,9;
18,31;
76,27;
68,29;
93,29;
37,10;
75,1;
92,40;
21,20;
84,13;
60,16;
33,87;
53,51;
24,90;
30,36;
59,32;
95,54;
51,71;
57,100;
31,4;
84,38;
76,5;
29,95;
31,48;
71,46;
8,54;
12,65;
28,54;
81,26;
62,4;
54,12;
80,42;
3,44;
35,95;
30,32;
76,85;
77,102;
1,37;
25,88;
83,3;
96,10;
61,7;
84,100;
26,76;
20,91;
51,22;
53,84;
75,68;
45,57;
20,97;
11,70;
11,5;
25,81;
94,87;
18,3;
59,87;
88,64;
12,83;
33,52;
29,17;
95,5;
32,32;
87,96;
57,3;
60,88;
98,27;
74,8;
72,98;
63,64;
11,49;
24,72;
69,72;
61,12;
24,82;
42,16;
63,95;
10,88;
90,32;
69,81;
33,37;
27,50;
80,32;
76,68;
23,51;
22,41;
73,54;
22,46;
7,73;
12,63;
33,12;
88,67;
29,44;
63,16;
25,49;
70,76;
66,47;
52,33;
5,39;
89,65;
5,16;
27,95;
27,0;
4,20;
91,25;
51,99;
34,73;
100,23;
19,80;
80,5;
50,100;
69,44;
26,76;
48,88;
68,26;
49,95;
53,16;
0,45;
19,71;
62,98;
22,85;
48,48;
81,34;
23,73;
57,64;
89,17;
49,60;
25,16;
16,62;
70,83;
52,3;
53,3;
59,28;
39,67;
59,71;
81,90;
87,6;
32,58;
99,3;
71,13;
93,25;
54,95;
66,76;
78,102;
47,54;
91,76;
98,87;
62,99;
44,85;
2,57;
10,19;
87,40;
77,27;
35,96;
84,83;
10,63;
57,101;
100,54;
96,44;
11,83;
17,87;
35,54;
66,2;
37,59;
67,36;
100,34;
52,81;
30,10;
7,74;
77,79;
40,33;
60,70;
25,66;
87,50;
86,6;
16,51;
72,31;
99,18;
95,38;
71,40;
63,2;
65,80;
58,82;
79,27;
8,60;
53,49;
64,81;
62,55;
46,43;
69,37;
31,58;
61,17;
56,98;
62,102;
46,28;
21,29;
83,65;
94,52;
32,47;
95,34;
32,37;
89,18;
28,88;
62,20;
83,83;
21,89;
58,31;
75,49;
44,91;
17,82;
94,56;
56,43;
9,27;
6,49;
64,39;
8,73;
58,83;
26,94;
20,69;
7,82;
33,25;
61,40;
25,39;
60,18;
91,30;
80,21;
74,102;
98,76;
21,23;
75,57;
13,11;
84,1;
80,23;
24,17;
4,55;
33,84;
30,82;
58,30;
1,71;
53,69;
68,11;
22,8;
82,93;
45,21;
11,81;
59,77;
11,34;
25,98;
37,55;
0,69;
89,12;
58,65;
29,102;
36,0;
94,54;
48,95;
39,59;
23,18;
84,91;
70,44;
87,73;
66,40;
97,30;
86,46;
90,73;
49,24;
76,77;
89,3;
57,99;
72,101;
77,27;
18,57;
18,68;
47,4;
52,66;
40,89;
80,19;
75,8;
35,20;
47,100;
66,60;
36,81;
17,55;
47,94;
75,22;
0,48;
22,2;
100,29;
68,5;
42,3;
97,31;
79,34;
95,66;
40,52;
36,102;
75,98;
89,90;
54,50;
20,72
];
positions+=1;
velocities = [
-47,36;
69,91;
-52,-60;
35,44;
-56,48;
18,37;
88,-65;
28,-40;
98,4;
33,-33;
-15,70;
35,80;
-47,-20;
97,8;
-44,-59;
-51,83;
43,73;
50,90;
-47,-44;
91,98;
-24,77;
2,-82;
65,-42;
33,-20;
69,-62;
12,68;
-97,10;
81,-93;
47,-61;
18,84;
49,50;
-70,-88;
54,39;
61,97;
10,-51;
21,-45;
42,49;
74,8;
-66,55;
-3,29;
56,-45;
-58,-59;
-84,-38;
-10,-42;
-11,23;
85,25;
81,79;
87,82;
-85,-22;
14,52;
43,93;
66,-99;
-71,-31;
2,36;
24,-83;
-90,46;
69,-53;
-34,70;
95,98;
-17,-37;
-94,47;
43,72;
-96,-14;
-56,-96;
39,6;
-14,-63;
23,-79;
95,97;
96,-36;
56,-71;
-11,43;
44,-64;
-35,-6;
44,-73;
-87,-6;
24,-66;
-32,84;
-10,-5;
-80,32;
98,15;
-76,36;
28,85;
38,-96;
-74,-17;
63,67;
18,51;
-38,37;
-39,10;
-19,-12;
26,-67;
-38,-63;
35,-33;
-96,-17;
92,-19;
-6,-83;
17,-42;
-55,-73;
-50,-48;
72,3;
-19,-63;
32,49;
48,17;
43,5;
93,40;
80,68;
38,71;
44,32;
-29,59;
-84,5;
-53,-64;
-55,-79;
-81,53;
-31,-4;
-84,-34;
25,-85;
-89,62;
-8,-8;
-45,-75;
-71,-69;
90,69;
39,16;
83,-32;
-84,45;
28,9;
55,92;
-64,56;
4,16;
-15,-9;
81,-51;
-91,54;
-32,38;
98,63;
40,-39;
-1,19;
-62,-56;
92,9;
18,-81;
60,78;
-99,-81;
47,-14;
-52,-15;
39,-83;
-41,-47;
-93,-4;
-65,-87;
68,71;
65,80;
29,46;
-63,44;
-46,53;
-18,93;
-55,-85;
-45,-29;
97,73;
84,-31;
-18,-58;
57,38;
-30,31;
-68,5;
-55,-3;
7,96;
99,-1;
-68,23;
59,-71;
53,75;
-75,-16;
64,89;
88,89;
84,-82;
-4,84;
-81,78;
-36,88;
-17,58;
-29,22;
97,-21;
89,55;
-61,-60;
-15,-88;
-20,-76;
-79,41;
-96,56;
-57,72;
79,82;
59,-23;
21,6;
-40,-73;
5,94;
57,-83;
24,85;
-18,58;
61,-7;
48,-16;
-67,-46;
68,-62;
-10,24;
39,29;
46,78;
4,-49;
77,82;
-70,-26;
61,75;
97,5;
87,65;
-61,51;
85,-29;
21,21;
89,-30;
70,34;
-96,47;
-42,-35;
-61,2;
16,42;
68,78;
94,34;
45,27;
71,91;
68,-46;
68,-79;
-90,25;
-40,14;
-40,-82;
-69,80;
8,41;
-49,15;
-7,23;
46,41;
-41,27;
-25,-37;
-22,-65;
29,-27;
-76,-75;
-17,15;
-96,56;
-96,17;
-13,11;
69,26;
-8,29;
49,-84;
67,-88;
-28,-32;
-77,39;
-58,-20;
-20,45;
94,6;
-58,-23;
55,-33;
-37,20;
14,-93;
23,90;
-25,82;
-25,46;
-43,26;
58,-57;
-27,57;
9,-56;
42,34;
-45,18;
84,12;
75,11;
-9,-68;
72,-71;
-38,53;
19,-64;
-11,-9;
-62,59;
-78,-91;
29,39;
43,-66;
-77,-14;
91,-72;
26,1;
-90,11;
-22,44;
-51,-25;
52,26;
-70,71;
-93,27;
45,93;
64,20;
-89,13;
44,-57;
-94,-52;
49,53;
28,13;
5,-86;
-21,-19;
-14,73;
91,68;
94,89;
95,71;
-37,14;
-56,-13;
89,79;
-85,-27;
91,18;
-24,33;
-93,45;
-96,-49;
-73,7;
10,84;
58,-16;
-91,34;
16,12;
-12,23;
-6,-3;
20,17;
46,12;
-15,55;
-82,-49;
-53,96;
-19,64;
-16,-80;
22,51;
91,93;
-24,55;
86,-23;
31,-64;
93,24;
-36,-8;
-78,-8;
42,7;
-99,6;
-54,57;
81,32;
71,-89;
-4,-47;
26,-60;
-45,47;
13,-46;
17,49;
44,47;
69,56;
7,-58;
-24,-4;
15,14;
-79,52;
-58,47;
51,50;
16,-5;
12,53;
-49,86;
4,59;
25,12;
45,-2;
-42,61;
37,-35;
74,-2;
73,-72;
-3,-58;
-24,-45;
-13,-16;
10,-1;
51,73;
67,81;
-32,61;
52,-2;
18,14;
-17,26;
-59,-24;
-20,54;
2,17;
9,-35;
-93,76;
36,23;
-31,-81;
-2,27;
40,-86;
-94,-2;
39,45;
80,90;
59,28;
96,98;
99,-59;
48,33;
97,-19;
35,99;
95,60;
84,27;
-28,-55;
-51,84;
-19,-25;
-2,37;
68,-48;
-40,3;
59,-36;
44,-30;
-40,27;
38,-91;
-87,-8;
7,-11;
-65,-79;
46,30;
-87,37;
-8,-15;
-24,-9;
54,59;
-69,-71;
67,38;
59,65;
31,5;
-80,-3;
-54,-76;
82,-66;
-47,9;
98,-90;
51,36;
-83,-7;
84,-79;
-11,92;
-39,12;
-93,-80;
-54,-82;
69,-42;
50,-41;
-29,76;
3,52;
26,6;
-64,-64;
-8,-15;
88,9;
-12,96;
-89,68;
-34,78;
56,49;
-20,-42;
-65,56;
44,-77;
67,-31;
-53,76;
87,29;
-25,-78;
-6,86;
-19,-61;
28,-93;
-92,-85;
70,61;
-29,-69;
24,-61;
6,-52;
3,-51;
-64,-24;
61,2;
-69,-12;
75,1;
44,-89;
-75,-29;
42,44;
10,-3;
-69,58;
30,-51;
55,-90;
35,82;
-25,-24;
-69,64;
12,17;
70,-56;
90,-68;
-94,34;
-21,21;
-81,-34;
21,-95;
4,-16;
86,35;
-82,-90;
-61,33;
-65,82;
7,-44;
-74,17;
-56,-59;
-25,42;
-65,94;
-81,-14;
-84,-70;
95,95;
-70,-23;
91,9;
-23,-21;
85,49;
5,56;
-32,-58;
35,-63;
60,25;
-7,-86;
-22,-84;
54,4;
-59,-96;
-51,73;
-22,64;
53,59;
-10,-31;
-54,-17;
58,-1;
99,-30;
-19,57;
47,46;
-67,-58;
-4,39;
-52,50;
30,57;
-84,-32
];

function newPosition = limitPosition(position)
    global ROWS;
    global COLUMNS;

    newPosition = position;

    if(position(1) > COLUMNS)
        newPosition(1)-=COLUMNS;
    end

    if(position(1) < 1)
        newPosition(1)+=COLUMNS;
    end

    if(position(2) > ROWS)
        newPosition(2)-=ROWS;
    end

    if(position(2) < 1)
        newPosition(2)+=ROWS;
    end
end

function gryd = plotPositions(positions, jj)
    global ROWS;
    global COLUMNS;

    gryd = zeros(ROWS, COLUMNS);
    toDisplay = gryd + '.';

    for ii = 1:rows(positions)
        position = positions(ii, :);
        gryd(position(2), position(1))+=1;
    end

    toDisplay(gryd > 0) = 'x';

    if(rem(jj, 5) ~= 0)
        return;
    end

    disp(char(toDisplay))
end

seconds = 7790;

for ii = 1:seconds
    disp(ii)
    positions+=velocities;
    positions = arrayfun(@(n) limitPosition(positions(n,:)), 1:rows(positions), 'UniformOutput', false);
    positions = cell2mat(transpose(positions));
    gryd = plotPositions(positions, ii);
    ULquadrant = gryd(1:floor(ROWS/2), 1:floor(COLUMNS/2));
    LLquadrant = gryd(ceil(1 + ROWS/2):ROWS, 1:floor(COLUMNS/2));
    URquadrant = gryd(1:floor(ROWS/2), ceil(1 + COLUMNS/2):COLUMNS);
    LRquadrant = gryd(ceil(1 + ROWS/2):ROWS, ceil(1 + COLUMNS/2):COLUMNS);
    result = sum(ULquadrant(:))*sum(LLquadrant(:))*sum(URquadrant(:))*sum(LRquadrant(:));
    disp("")
    disp("")
    disp("")
    disp("")
    disp("")
    disp("")
    disp("")
    disp("")
    %pause(0.1)
end

% assert(228421332 == result);
% assert(7790 == seconds)
