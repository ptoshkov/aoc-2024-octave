data = [
"##################################################";
"#...OO...#......O.O.#.....O...O.OO..#......O.O.OO#";
"#.#.....#.....O...#..O.....O......O.........#..O.#";
"###.OO....O..O..O..O...OO......O##..O.#.O...OO..O#";
"#OO.O.O...OO..O..........O...O.......OO...O.O##..#";
"#..OO.O....O.......O###.O.OO.O.O.......O...O#.OO.#";
"#.#OO.O.#....O............OOO............#.OO.OO.#";
"#.O#O.O......O...O.....##....OO.O..#..O..........#";
"#...O.O...O..O..#..O........O.....O..#O.OO.O..OO.#";
"#....O......O.OO#O..O....#.#O..O......OOO...O...O#";
"#.....O...O.O............OO..O#.O.....O.........O#";
"#..#.O.OO..OO...O....O....O...O.O..OO.O.O#.OOO...#";
"#.......O..#.OO.O..O..#.O##.##O.#O....O....O...O.#";
"#OO..##...#...#...OO.OO..O..#O...#....O....O.O...#";
"#O........#....#O.O.....#......O..O......#....O..#";
"#.O...OO.#O..O.#.....O...OO#..#.O.#.OO.OO........#";
"#OO#..OO....O......O..OO.O.#O.....#....O...OOO.O##";
"#O...O.OO.....O.......O....#.O......OOO..OO.#....#";
"#.O..........O.....#O...#O.O.OO....O.#....OO....##";
"#...O...O....O....O.#.O..O....O.#.OO.OO..OO......#";
"#.O#.OO.#..O..#......#..O..O...#..#O#..O..O..O.O.#";
"#.O..OO#O.........##....O...O.#O...OOO..O.O.O....#";
"#.O.OO#OO.O.O..O...#O#O...O.O.O..O.#O....O....O..#";
"#.#......O...#OO.OO....OO...O..O..OO.O#O.O.#.#O#.#";
"#............OO..O...O..@..........OO#........O..#";
"#...#...OOO.#......#...O....OO.O.O..##O..OO...OO.#";
"#....#...O.OOO...O..OO..OOOO#.O.OO.O...O..O......#";
"#....O..O#O..OOO..#..#....##OO..O...#O..O..O.OO..#";
"#..OOO..#..#.......O..O...###O........O#OO...O.#.#";
"##...O...###......O..OO.O.O..O...#OO..OOO.O.O..OO#";
"#..O....OOO....O.O.O.....#..O.O...........#..#OOO#";
"#.OO.OO#OO....O#.#.OO..O.O.OOO.O....#.#..OOOOO.O.#";
"#O.O...#......O.O....O......OOO.#.........#......#";
"#..........O...........O.O.O...O..O......OOO.O.#.#";
"#O##O.O.O....OO..OOOO...OO.OO...O.O..OOO...O#...O#";
"#.OO..OO.OOOOOO..........O..OO..#O.O...##....OOOO#";
"#.O#...O.O...O..........O.OO..#OO.O.O.#OO..O..O..#";
"#O..#....O....OOO...#.#..O..O#O...O.......#O..##.#";
"#.O.O..O#OO........O.....O.O.#.O.OO.O...O...#...##";
"#..#...O.O.......OO.......O.#..O.....OO..#.O....##";
"#...O....OO.O...O.....O.........#.....#.OO.O..O..#";
"##.......O.O#..O......O.O........O.....#..O.....O#";
"#...#O.O.#O...O...O.O.....O...O..O...O..OO.O#.#..#";
"#.#O..#.O...#OO........O.......O............#.O..#";
"#..OOO..OO....OOO........#...........OO....O..O..#";
"###.OO....O.....#...O...#....O.....OO.#......##..#";
"#.O#O.....OO#.O....#.O.O..#.O....O.###...O..#....#";
"#..OO.O#.......#.O.OO.O...O.#OOO..........O...O..#";
"#....O..O..........O....##O..#...O....#.O..O.....#";
"##################################################"
];
moves = "^><v^>v>vv>v^>v>>v^^>v^^<>^^^^v^><>vvvvv^^v<^><^<v>>>^^<><v^v><<v^v>><><v<<<^vvv^<^^v^<vv<v>^>^<<v<v^^<^<^vv<>v<>^>^v^<<>>>v<^^^>>>^<v<vv<>^><>^v<<vv>^^>^v^vv<>v^v^^^vvv^<v^<>v^^<vvv>>^<^>^<>v^<<v<>^^>v<>^>v^<<<vv<<>><<<<^vvvv>v>^^<v<^>v<<<^v^vvv^>>vv>^<vv><<<><<^<vv>>^v^>^^>^^>>>v<>><<<<v^v>v^^<>^>^>>^><^^><>v<<>>^^^v^^<^<<^<v>>>>>^<><<>^^<^>^v^>v<>v<<^v<<<vv>><>>^^<v><^>^<<>>>^v<>^<^<^>><v<^<^^vv<<><^v>>>>>v^^<<v<^v>vvvv><vv^^^vvv<v^v>>^<<v>><>v>v^^^<v^^<^>^<>vv<>^<>><>^>v>>v^vvv>v>^>v>^^>^^>v^<<<^>v>^v>>v<^vv^^^^><><<><^^>v<<vvv^v<vv>^<>>v^v<<>vv<^^<v^>>^vv>v^^<>^>^^>v>^>>>^<<^^<^^^^^<v>>^>>v<^<vv>v>v><^<^>><^v<v>><<^<>>v^>>v^v>>>v>^>^^><^<^<<<^<v>><><vv^>v>^<^v^^^^<>vvv<v<><v<>v<v<>v><><><<v^v^^>>^v^>>>^<>>v>>^v^^<<^^>^<v><^^^^<v>>^>>^^^v<^^^<>^^<<^^^<^v<v^^>>^<v>^^<><v^<><>^<v<>^>^>>>^vv^^v^<^>>v<^vvv>>v^^vv<vv^vv<>><^v>v>^<vv^>^^^v^<<v^>>>^<^^v<v>^<<><>><^^^v>><^^vvvv><^v<>^vv<>><^>^>>v>>^v>^^<><>v>>^<v>>^v<^<v>v><^<v><v>v>>^<<vv><^v<><^<v><^<v>^<<<<^^v<^<><<v>v<<v><v^<<<v<^vv>vv<><v^<^^^>>><<<<v>v<v>^^^<^v<v<^vv^<v<>>><vvv>>v<^>^^^<v>^^>>>v<^vvv<v^v>v>><><vv<<>v^v^<^>v^<<<>><vvv>^^v^>v<vv^v>vv>>^<>^>>^><<>v><vvvv><^>><^><<^v^<^^vv<<v^>v<<>><<vv><v^vvv^<<><<<v<<<v^^^^>><><vvv^v>>^v<<>>>vv^v^^^>>^^^><^><<>v^>^<<<v<>v<<^>>>^v>^<v^vv<>^<>^><<<<^>^v^^<^^v><<<><<^v^v<v<<<^>>vv>vv<vv^>>v<^>^><<<^vv>^><v^<<v<<><>>^>v<><<><><<>>^^>v^>^^^v>>>>><^^>v<vv>^><><vv^vv^>^>>>><^>^vv^^<>>^vv>>>vvv>v^><<>vvv^v^<<<^vv>v<v<<<<>^v^><>>>v<^^<vv<^v^<><>>^v<^vv^<<>>>v<v>v^vv><>^^>>vv^v<<v^^<^>v>^<^<>^>v^^>>vvv^<>>>vv>vv<v<v^<<>v><^<><><v^^^v><>^v^<v^v<><v>^vv><>^>^<v^<v>^v^>>>>><vv^v><^^>vv<><^<^>^v>^<<<^^>v>>v>><>>^<v>^<<^<<>>^<>>v><^v>>>^^^v<^^^^v<><>vv<^>>v<v^>>>>>v<v><>>^^v<^^^>>^v>^v<v<v>>^v<><<<^v><<^^><^^><<>^<v<^^v>v><<^<v<v^>vvvv<^^^<<<^^>v^<<<vv><>v<<<^>><<^<><v^>vv>>v<^><<<>>^v>^<^<vv<>v^v<vvv^<>^>v^<><>^v>^^^>^^<><<><^>^vvv^>>>^v>^v><vv<^v^^v>>><^^>>vv^<><^>><<v^v^>v><<<vv<<><><<v^<^<<>>v^^^<v^^<<^v>v>v^v>>v<<>v^^>>><<<^>><v^^^^>>vv><^<vvv<v<>^><v<>vv<><^<><vvv>v^^>v<<vv^v><^v><^^>vv>><<v>>v<^^<v^^<vv<v<<>>>vv^v^<<vvvv>^^v^^v<^>>v>^<<^v<v>>vvv<vv^<<v^>>^>^v<v>^><^<v^v<<v<<^<<<<<>v>^><<>^v^^<^v>^<^vv<^<^<v^>><v>>>>><^<v^>^>^>>v><^>>><<^<>vv^v>vvv<v<^^<>>v^>vv<v<^<^>v^<<^v^>><<^v^<><<^>>v<<v^^<><^v^<><<>^vv><>>>>>><^<v^^v^v>v^vv<v<><<^<>v>vvvv^v<^>>^v<>>>>v^<<>><>vv><>v>v<<>^v^>>vv>v<vv^v^vv><v>^>>>>>>^^>^^>v^^<^^>>>^>^<><^>^v>><>v>^v^^vv^><>v>>>v<><<<<<<><v^><v<^>>^<v>>v^v>v^v><vv^<<v^><><><>vv^>^>vv^v^<>>>vvv<v^><^v^>^<<><^>^v^<^>^>><<<<>v<vv<^v^><v<<^<>^>^v^<<v<><<<^vv><<v<<v>^<vv<v>v^^^vv<<v<^>>v<v<^<v>^>><^^<vv<>><><vv<^v><>><^v<^^vvvv>^>><<v^v<v>>^>^<<>>^^vv^vv>>v^<>^<^<>^v<^vv^^<><^^>>>vv>v^^^^^v^<>><vv><<<<^<^v<<>>^<><^<<^><^^<v>^^>v<v>^>>vv^><^>^><>v^>>v<<>v>vv^v>^v>>^v<vv<^^^^<<^>>^<^v<^vv>^^><>v<<^^^><v>vv^<vv^vv^v<<^vv>>v<>v>^v^>>^^v<<v^<<^vvv<v>><v^vv^^v<<^<><><<v<^<>>>vv<v>>v<><^<v^vv<v^v<^<>^^^<>^^>^^^^^v<>>>^<>^>v>v>v<v>^v<><^<v<v>vv<v<>v>>vv<>^>^><v><vv^>>vv<v<<^v>v><><v>v<<vv>v^<v^><^<>v<^<vvv><><^v><^vv>^>^v<><>vv^^<<v><v>^<^^v>>v<vv>vv^^^<<>v^<^^><>>>><^<^^v<<^<><^^^>>v^><^^^^v<^v>v>vv>>><<^^^><>v>^^><vvv<><<^<><v^>^^><>><v^>><^v^<>v<v><<>v>>^><vvvv^>v>>v^<v^<vv<<^v^v^>>^v^<<vv><vvvv^^vv<^><><><^^vv^<><^<^<v>>^v<<<<<vv<<v<<>v>v^<<^<vv<>v>v<^v>>v^>vv<^^v^^v>^v>^^<><^v>^<v<vv<^v<v><v<^>vv^<><v^><v^<v^>^vv<<><<vvv<vv^>>><^<v>><^<^^^>>^^^^><<<<v^v^<<^^>v<v>v>^<>^>><v<<<^<>^^<v^<v<><>^<^>vv>^><>>vvv<v<^^v<^><^^^^^<<<<v<^v>>^>>^>v<<^vv><v^^^>^<<<v^v<>^>>>v>vv>v^v^v>vv><<<<^<^v<^v><<<<<vv<>^v>><<<^^vv>>>>v>v<v>^><v><v^><<<v<>^^vv<v^<v>^vv><^<>><<^^><^>vv>>v>><><^^^^^^v>^^^><v^^><v><<><<>^v<>>v>>v<v<>v^>^<^^<<^v<^<>><vv>v<>v>v^<>v^>v<v^^vvv<^vv^^><^>>^v>^>^>vvv<^^v>^^^><>v>^^>^<<vvv<<^<><<>><<>>^v^^>>v>>>vvvv<<^>>vv>v^><vv><>><v<<>v^v^>vvv<>^v>vv>v^>^v<v<v>v>^<<><>^><^><>^vv><><<^v<>v^<^<vv^><v<vvvv^^><v<>^>^v^^^v<>><<><^v>v<<>^<<<^^vv^>^>vv<^^^^v>^^^^v>>^>v<>>>^<<<^<^>^^v^^<^^v<v><<<v<>v<v^^^vv^><vvv^><vv>>v^v<^v<>v><v>v^<v^>v^v<<vv><>>v>v>>v^>^^<v<<v<^v><<v>>>^^vv<>vv^<^v<^^>v>>><>>^>>><<v<<^<^>v^^<v^v<^vv<<^v<^<>>^^v^v><v>^<<^<<^<v>>v>><^>v>^^<><v<v>><v>vv^^v<^^<v<<<<>^^^v^^><<>><^^<v<>^>v>><><^^<<><^^<^<v>v<>vv<v>vvv^>^^vv><^<^^^^<^>^>>v>v<v><^<<vv<>^^^><>>>><^>^<>^>^^<^><<v^>^<^>^v<<v<<>v>>^vv>>^<<vv>vvv><>v<<^^<v^v>>^><v<v^v<>^^vv>^^^<<><^vv>^>^v^>^<>^<^>>><v<<<<vv><v^v<^^<^>^>^>v>><vv>>^><<^^vv^v<><^v>^<v>^>^^vv^<v^>>^^^<^v<v<>v><>><<<^<v<<^<>><v<>v^v<>^^<><>^v<v>^^vv>^v<>>^^>>>v<>vvvv<vvv>v^<^<vvv>>v^v^v<<^>>^<<>vv<<^^^^^>^><v<vv^vv>>v<^vv>vv^<v<>>v^v^v<v<<^^v^<^<>>v>v><<<<>>v<>v<^><vv>^^v><^<v<<^vv>><^<>>>^^vv<>v^<^^<><<v>^vvvv<^v><^<v<v<^<v><<^<v><^><<v<<v>v^v<^<>v>v^^><>>^^<^v>>^>^^v>v^><v^v><>v^<^<v>>v^^>^><^^<^<vv<<>^<^><>>>><<^>>v<><>>>>>v^vv><>v^>><v^<^v<^>><<^<vv<^<<<<>^<>^<<v>><>^<^>^>>v^v><^<vvv^^^^<v<<>>><v>v^<>^^^<v><><^^<<v>^vv<>>^>^>><v^<<<v<vv><^<^>vv<>v<>^<>^><<><<vv<<<<<^<^<<<^>>^vv^><^><v<^vv<vv<^v^><v<<^<><<vvv<>>>>v>v>><v^^>^vv<<<v><^^^v^^<^<>v<v<^^<^^>^>^^>>>><<<>>^^v>^v><v><<v^v>>^vv>^^<v>^^v^<^^vv<^v>vv^<^^^^<>>><^<^>v<v^>^<<vv^>^^<vvv>>>>^<>vv><<<>>v>^<v>>>^<v^<v<>v>>>v^^>v>^>^<><<^v<>v>v^v^>v^^><>v<<>^><<>v^<v^vv<>^v^^^>>^<<v^v^v<>^>^>^^<<<v><^><v^>>>^^<<>^<^>>^^vv<v^vv^<>>v^<<<vv<>^<<^<vv^vv>vvv><>v^^<v<>v>^<^<<>>^>^^><><>vvvv><>^v>v<v<<>^<>v^><>^<^^>>>>^>>^><^v>>><>v^^<^<v>^v^><^>^vv>^v^>^v<v<><<>^>>^>v>^^>v><v>>>v^><<v<^<<v<<<>v<<>^<vv>v^vvvvv^v>^v<^vvv<>^>^^^v^v<^<^v>>vvv^<><v>>>><<<>>v>>^^^>>v><<<vv>v^>>>>vvv<>vv^v<^^<>^v<v>>^>v<<>^^>^v>>^^v^vvv><>v^<>v>v^>>v<^>^^>v<<>vv><v<v><^v^><^v^^>^<v^^v<<>^<v><>^vv<v<v><<<<>^^>v^<<<<^><v^^^<>>><<^<^>v>v^><><v<^>><>vv<v^<<>><<v<v<^><<v<^>^v>^v>>^v<v><<^><>>v^<<<^>>^<>>>vv^>><^<v<vv<>^^v<><^<^><<><<v>v^><v>><v^^<v<^<<<>>^<>>v>v>^<<^^v<<<<<v<v^^v^<<^^<><^v>>^<v><>>^>^<>^<^>>^^^v<<^v>^v><^<v>>^v^><v<>vvv^vv^<<v>>v^>>v<>>^^^>v><<^v^><<>><v>><^<><^<^v^vv<<^>>v<v^<^^<<>^>v^>v^>>>v><><><vv<<<>>><<v<>^><^>>v>>>><<v<<<>vvv<>v>v><v<v^>v^v^<^v>vvv<^<^^>^v^<^^<<vv>^^<v^^v^<^>^>^^><<<<^<<<>><^^>>>^^<>>^<v><>^<>>^<><^>^<^><<>^<>v<>>>v^>^>^^<^>^^<vvv>><<<<^>vv^v^>vvv<<<<<>^v>>v>>^<^><^vvv<<>vv<v>^<v<v<><^^>^><<v><^>v><^<^^v^^<v<>v>^><<>^v^<^<^vv><v<<^v<><>^^^^v>><<^v>vvvv>^^<^>v>>>v^<<v<>><>v><>><>v<<<<<<<>>><v^<><><>^>^^<v<v^>^^^>>v^<<^<<v^<<<v<^<v><<>vv<<>v<<>v^v>>>^>^vv^<<vvv^<><><^><^>v<>^>^<^><<v<^v>>^<>>v^v^<^^>v^v<>>vv<<^><<v^<v<^<v^^^^^>>>^><<<<>v>><^v>v>^^vv>v<^>>>>>>>vv>v>^>^<<^v<><^>>vv<^v<v><<<>>v<<><v>>v^<^<>>^v>v><<^>>><v<<v^^<<^vv<<^>v^v><v><<v<^v<<>>^vv<<>vv><^^>^<v>>>v>^><v^>^>^>><>v<<>v>^v<<<>^>>v<>v^><^^<^<<<^<>^<<<>^>v^>v<><>vv^<v^^>^>v>vvv>v<v^>^>v<^>^>^><<v^^>>v<v>^<<>>v>v<>^^v^v^<<>>>^^^^^vvv^>>v^<>>v^v<^<^^vv><vvv>^<^<<^><>>^<v>^<><<<vvv<<^v<<v^<<><^>><^v^v<<<><>v<v^^>v^>^>><>^><v^vvv<><>v>><v><><>^v>>v>vvv^^<<>>vvv^>>^^v><<vv<><>>^v<^>^<^><^vv>^v>>><<<v<^<>>v^<<<^>vv<v><>^v^<v^v<v<vv<vvv>>^>vv^vv<<<<vv^^^v^^><<vv^<v<^<v>^^><v^^<v^^><v<v^>>vv>><v>vv<^vvv^<v^vvv<v<>^>><^>vvv^<v^v>^^>>>^^>>^<<<v<<^^><<^v<<^<<<><>v^^<^v^>^vvv<^^^>^><^^v>v<>><^>><v<v^v<>vv>>v>^<<<^<>^v<>>v^v>^>v^vv>v><v>vvv^vv^^<^v>v>v>^<^vv<v^>v^>>v<v^<^<v<>>^><>^^v><<<vv<v<v><^<>>v><<<<^^v>>>^^<^v>^>><^<^<^<<^v^v<<>>v^v^^^<v<<v<v>v<v>vvv^><>^v<^<v>v<v<^>v^^^><<^v^<<><^^vv<^>v^<^^>vv<v<^vv^^^<<>v^<^<<^^><<^^><^v^>>vv^v><v>^<^<v^v<v>>>^^<>vv<v<vv^<><<>>>>v<^<v^><><v^>^^vv<<^v<<<v^^<<><v<>^>><^v^<<>^v>>^<<^>v<^>^^>>^>^v<<v^^<>^^^v^<^v>><^<v^<v^<<v>><<<^>v^>><><vv<>v^^^^<vv<<v>^^v<>^^<v<<<><^v<^^vvv><<>>^>^^>>><<<>^>vvv^>^<^^<vv^v^<^^v<^v<^<v<>>>^vv<v><vvv^><v<>v<^^^^v<>>v^v<^^<v><v<<<v>^<>^^<^v><<v^^><^v^v<<^^><><v<^<<^<><^^><><^vv<^>vv<^^<vv^^v^>v>>v>><v^<>vvv>^>v^^><<<><vv<v>^<^v^^<^<>^v<^>vv<vv>vvv>><><>^<v>^vv><^v<^<^^vvv<<^<v<v>v^>>^v>v^^^<^v^>v^vv<<^vv<^>>vv<<>>^>^<^>^>^vv<<^^<^<v^<^>v^<<<^<^vv>^^^^v<vv<<>><v^vvv><>v^^<>^>v<>>v>vvv><>v<^><^<vv>v><vv>>>vvv<v<>v<^v<>><^^^<v>>^vv>^<v^<<<v>^<v^^v<<><<^v>vv>v<v<<<<<>^^^>vv<<>vvvv<>vv^^>vv^<<vv<><^<vv<v<^<><v>v<vv><^^^vv>>v^^><<v<vvvv<^<v^>^><^^<>vv<^^^<^<<vv>^>vv^>><<<>v><v^>>v^vv<^v^v<>^<>vv^v>v>v>^^<>^^><v<<^<<<<<><>v>^^>>^vv<><v^^v>^^>v^<<v<^><>><^<<v><^>><<v<<^^v>^<v<^<v^^^vv^^<v>^<^<v^>>>><vv>><^<<vv^<<v<<v<vv>><^<<><>v^^^>^^><<^<^^><^vv><><>>vv>^^^<<><<>v^^v^>^v^v><^>^^>>>vv<^v<^^v<^^^>>>vvvv>>^v<vv<v^<^^>>>^>vvvv>v<>>^^v>v>>^^^<^^^>>>^<^>v>v<vv<^^<v>>><>^>v^^>^<<v><^^>><v^><v><>><<>>^^<><^^v^<>^>^>>><v>>>v<>v>^^vv>v^vv^^<<^v^>vv<^<^><^>v^>v^^^>^^<<v>vv>><vv^<<v^v^vv<<v><v^^v<^<vv>^^^<<>>^<^v^<<^<vvv^v>v<v<>^>vvv^^^<v>>>^>><<<^v^<^^>><<^<>v>v^<<v<>v><><v<v<^vv<<vv<<<v>^v<^^<>v^v^^<<<>^vv><v>v<<^v<^^v^v^><<<<^^^^>^<>>>vv<>><^v^v<v^^>^^<^^>v^<vv<^>vv^^>v>>>v>v^^^v^vvvv>>vv^<<^<v>^^^v<<><v^>^v>>vv>^v>v^^^^^^^v<><v^v^v>v<v^<^>^^<<<^v>^^v^vv>vv>>>^>>^<>v<v^><v>>><<^^><>^>^^><v^v^^v<v^>v<^<<<>>>v<>>^<^v>>v^^^^<v<^^>>v^>v^<^^v><^<><>>^>^^^vv^^<vv><v>vv^^<^>^^><<>v<>^v^v>><vvvv<^>v<><>^v<^^><v<vv<<<^^v<>><<^^>>^>v>v<>v^^^>^^^><><>vv^v><>v<<v^^v<><v>v^^<<vv<^^<^v^v^><<^<vv^v<<>>^<vv^>v><v<>v^^v<>><^><^>>^>^<>v>^v^><>^<v<>>v>>v<>>^<>v^^<^v>^>^^^>v<^<^>^vv><<v^vv>>^>v>vvv>><<^><^v>^>v<^>v^><<>v>>^^>>>^>vvv<^><vvv>v^^>><v^>><^v<<<<vv>v>v<<v<<><>^^><^<>v>>v><v><^vv^<>v<>><v^v>>v^<vvv<^v>^^^<>^>^^v<^^^^^^<<v>v>v^^v<<>^^^^<^<<^>^><<vv><v>>v>>^><^<vv^<^<>>^>^^^v>v^<<v^^<v>>v>v><vv^<v<v^>v^><vvvv<v>vv>>>v><<>vv><>v^v><<^v>>^>v>vv<v>v<^v>v><v>^>>>^v^^<<<vv><^<v>vv<v<>^>v>>^v<vv^v>v>v<vv^v^>><^v>^>^^>v^v<<>>v<<>v^<<>v<<>vv>v>v<><v>>v^vv^>^^^vv^>v^^>><v><^<^vv>v>><v<><v><^>>^<>^v^<<><<><v>vv^<>vv^<<<v^v<^<v^>v<^<v^v^>^^>^^v^vvv^>v>v^>vv><><><>vvv><v<v<v<>vv^><>^<v^v<<vvv^v^>>v^v^v<v^<v^<>><v>v^^<^<<>vv>vvv^^<<>^><^^vvvv><v^<v^v^v<<<>^<v^v<<^v<vvvv^>>^^<vv>v^>^^^><v>>^v<^^<^<>v>>v>^v>>v><^^v^<^v><>v<><<<>^>v^^v><<v<v<<<^<vv<><^>^<>>v>^>vvv^<v>>^<v><v<^^^v>^^v>>^>^v^>>>^v^>>^v<<<>>^v^<^v>v<v<>^^>^>^<^v^vvvv><^><>^v^^<^^<^<>v^v>^v^>>^<>^>^^v<vv^>^^v>v^v>>vv<<<^>>^>v^^<>^<vv^<>>^v>v^><<<>v<v<v^>^^vvv^^^><^^^v>^<<<<^^>^v><^>^^^>><>vv^<^>><^^<vv^v<v>>>^>>><<<>^v<<^^><>v^^v<>><>^v<<v^^<<v^><^^v^<vv>^<v>>v^>v^>>v^<vv^>>><v>vv<^<>v<v<^^v<^<<<><<^<<v^^<^>>>>^v^>^^^^vv^v^>^>>>>><>>^>>^v>^>>^>^v^v>><v^<v<^>v<^><^v<v>v<>>^vv^vv<>>^vvv<<<^<<v^<vv<<v>>>v>><vv<>v^<^><<>vv<<v<^^v<vv^<>^<><^>>v<<^^v<v^<<><>v<><^^<<><><>>v^v<<vvvv^v^>v<<^v^v<vv><><v^>>^>^v^<^^vv>^v^v<v><>>v>v^v>^<v>>><<^>^^<>>v>^><v>^<>^>^^>><>^<>>vv>v<<<>>^<^<vv^v^<v^^^v<<>v><>v^<>^<^^>v>>v^><<>v^<v^><^^>vv<>>^vv<<<^>^><^>>>^<^>>^^v^v^<^^^<v<<v>>><vv>>>><<^<<<vv<^v>v^><>^<>>v>^^^<^^<^>>><^<v<>v<<<v^<<>v^^>>^vv>^v>^>^<><<^^^<v>vv>^<>v^^<<v^vvvv>v^<^<><<^v^><>><>^v^<v^><vvv^><>^><^v<v><v^^^<v>^>vv<<<^><<>>^><^>^^>vv<>v<<<v^v>>^><^vvv>><v^v^^>><<<<>^>^>^v<<><v>>v<>v^<^v^v^>>>v>^<v><<<><^^v^^^v><><>>v>>>^><>^vv^vv>>v>v<<<^<^<<^<^<^^v^<v>>^^<v^<<v><^^vv<>v^v<<v^>v^<^>v>>^^v^v^<v>><^v<<^^<<<^>^<v^^v^<vv<^>vv<>vvv^vv^<><<^v><<<v^<><^<vv>vv<<v<vv^<<v^>^<<<^v>v><<v>>v>vvv<v>v<><^<^<>^<<^vv^v<^^<<><^>><vv^^>><^>^>^^>vv<<>^<<>vv>>>>><>>>^^>>^<><>^v>^>><><^v^<>^vv<>v<v<^^>^vv>^^^v<v>>>>>^>^v><^<<^>>v^^v<<<v^^>^^>v^<^<>v<<^^^vvv><^>^<v<vv^><>>>^<<v><><^>^^^>v<><^v>>v<v><<^v>><<<v^<<v<>vvv>v<>vv><vvvv>v>^<<^<vvv^<<<>v<<v><vv^^<<vv^v><^^^<^<^v>v>><v<>>><<v^^>^vv>^>vv^><^<<^^<<>v>^<>>v^<<<^>^<^><v<^>>^<>v><^<>>v<v<>v^>v^<^^v<<<v<^^<v<^^v^<vvvv^vv>>>>>^^>v^^<><<<v>^<>^<v><<<<v>>v^<v^^^><><><v>><<>vv^><^v<><<^^vv<>^v>^vv^vv^^>><>v<^<v<v^><><v^v>^vv>v<<><<^<vv<^^v<><^<>>><^^^<^^v<<<<^<<v^^v>>>^<v^^vv<>>>><>vv>>^<>>^v><><<^<<<^<>><^^<^<<>>>v^v<<<<>v^>^<>^v>vv><>>^<v>><>^^v^>v<<v<^<<>>>^<v><<<>^<<<^^^<<><>>v><><^v>^>^>^<v>v>^v<>v>^^v^<>vv>v>^><^^^v<v<<>v>^>^>vv^<>v>>v>>>^><^v<>^^<^<<v<v><^>v>^v<v^>^>vv^^^^<<^<<^v<v<vv>^v^><<<^<<<>>v>^<>^<>v^^v>^<^v>^v^^>^<v>>^v>v<^v>>^v^vvv<<^^<^^>^>^>^><>^<>v>^v<><<vv^^>^^>v>^v^v<^>>^^^><v>>^<v><>>^>^>>vv><>v><<^><>v><><>v<>^^<>>v>^>^v><v^v<<>vv^>>v><<v>>^><^<^><<^v<>>^<v^<^<v>^v<v>><^^^>>>>v^^v>^^>^<v<<vv>v^<^><^>vv<v>^v>v<^<>v<><<<v<vvv^v<<v<vv^vv<^<v<v<v>>^v<^vv>>>>><v<<^>>^<><v^<^<<<>><<<>^vvv^<^>>v>>v^v^vvv>^>>>^^<>><<<>^<><^>^v<vv>>v<vvv^<>v>v^v<^>>>v^vv<<><<v>><v<>>vv>>^^>>>>^<v^v><><>><vv>>v^^vv>^v<<<vv<^<v>>^<^<v<<>><>v<>^>^<>v<^^>>^>vv>v^v<<vvv><v^v><v<v^^^>>>v^<<<^>^<vv<^<>^>v>><>^<^>vv^vvvv^^><^v>>>^>^<>v>>^^>vv^v^^><>v>^<>>^>^>^v<^<<><<>^^<^<vv^vv<^v>vv<<><^^<<<v<>vv>v^><<<<<>>>^>^<<^<<>v^^>>^>v<^>v^<>>>>v^v^^v<<<<v>><^>^><^<v^<<^^^>vv>><>>v^v>><^v^^^^<^v<<<^^><^>>v^^<^^v<v<v<v^<v><><v<^>>^^<<><<<^^<>>>>>^<^v<<<^v>v>vv<v^<vv^<><^v<>>v^^>vvv^<vv^^vv<v><<v<<^<>>v<>v<v^^<vvv>vv>><<^v<>>^><<vv^^<>v^<><>v^vv>>^<><<^><vvv>vv>>>^^>v>^v>^>v<<>vvv^<<^v^>>><<v<v^vvv^<v^^>>>><v^v^<v^>v^^>^v>v^<>v<>v<>><<^^<<>v>><>^^>vv^^>>>>>^<v^^^v^^>>><v^^<v>^^v<<vv<>><<v><^<>v<^>^^<^<v^<>v><^^^^>>v<v<v>^v^<^<^^v<^>>^<^^^>^^^^^>^<^v^v><>>vv^>vvv^<vv>^<><v<<>><^v^>><<^v<^<>^<v>^>^v<^>vvvv^^>^^v>v^v>v^vv^>vv^^<vv^^v<><^<^<v<><>vv><^v<v>^vvv<>>v^>^^^><<^><<v<vv>vv^<>v^v>v^<<>vv>>^v<^>^>v^vv<^<>>><^<>^><>^><^^^>>v^vv<<>v^<>v<<vvv<><^^>>vv^><^>>v^vvvv^^v>>>v><<>vv<^v^^^>v<v^<v<^>^^<<<v^<^>^<>>^vv>^><v^^^>^<>>>^v<>><v<><v<^v<><^^^<<>vv><>^^<>v>>>>v><^v<>vv^>^vvv^<v>^^>^v>v<v>^^^^>v^v<<v^vvv<^^>^^>^<>^>>v^>^<>>^^^^>v^^^^>v>^>>v^^>>^>>>^<>^>><><<v<vv<^<v<^<^>v><^<><vv^>>>v<<>^v^vv^^v>^vv>>v^<>^^<v><^<<<vvvvv><>>v<<>><vv<vv^vv^^v^><v^v>>^><>v<<<v<<>><^v>>>^<^>v^^<<^^<<^>><^v^v><<<^<^<>>v^<>v>^>v>^^v<>vv<^vv<v^><vv>v^>^vv>>vvv<<v^v<<>>><<>^<>>v^v><>v^>^>>^vvvvv><v>v<<>^^v><^><^^><>v>v>><^>^v<>v>><^<><<><v^^<>>v>>>v<^<<^^>^v>v^>^>v>^>>><v<^vv^>v>>>^^>>^v^>>>>v^^>vv<><^<^<^vv^vv<>vv<vvv^^^vv><>>v^><<^vv<<>vv>>^vvv^vv^<>^<v>^^<>v<vv<<v<v><v<^^<^v>^><<^>v>v><v^vv<<<vv>vvv^v>v<<vvvv<>>>>v<<v^><^<v<>^v^>vvv>^v^>v>>><>^<<<vv<>v^vv^>>>v>^vv^<><<<><vv^>^v<>v<v>v^^<vvv<<><v^<^>^<^^^v>^vv>^v^><>^<v<^^^>>>^<<v><v^<>>v>>>v<<vv^<vvv>^vvv>v^v>^vv>^vv<^^>vv^vv<<^<<>>>v<v>>^^v<^v^>^>v<^><v^><><><<vv^v<v<>v>^<><v^<v>><v<v<<<v>>>>vv>>>v<>>^^vv^<<>>>>><^<^<>^<^>vv>^^vv<v>v^<><vv^>>>vv^<>^<>^vv<><>>>>^v<>v<v<^<^v^v^><<>>v<^^^>>>>>v>><^v^v^^^<v<>vv>><^v<v^<>v<v^v<^>><v<<^^<<^<^^v<<v<v>^^^<<v>^<v<<^v><<^>^<>^>>>^^v>vvv^<<^><^<^<<<>v<><v><^v^<>v<^^^^^<^<<<^<>v^v^<v>>><>^^v^^<<>v>vv>v>v<v<<<>^v>^>>v<^^<vv^>><>v<>v>>>^vv^^>v^><>^^vv^vv>v<^<><^<<vv^><<><>>^><^v>><>>v>v<<^vvvv^^^<^<^^^<^><v>>v>^v^^v>^v^vvv>^>^v^vv<>>>>^<v<<^^>>vv><v<v<vv^v^v<><<><v<<<<<^<^vv>v^^<>><vv<>v<<><^<<>^v><v<<>>><>vv>><<vvv>><^^<<vv^<v<<^>v<v>vv<<<>>>v><^v>v^><^vv^>><>^<<<<^vvvv^^><^^v^^<v<v<<v>^^>v<<<^<<<>vv>^v^<<>>>>>v<>^<v<^<>>v<vv>^<<v<^^<<vv>^<<>^^>^>^^>>v<v>^^v<>>><^v>^v^^><>^>^>^^vv^>^v>v^<v^vv<<v<vv<<<v>vv><v<><v<>^vvv<^v^v^^^<>>>>>^vv^^<^>^>>v>^<<<vv^vv>^v<><^<>^>>^^^<^^^^^>><v^v<^vv^<<^vv^>^v^vv>^>>^^<><v>>>><v^vvv^<^>^>v>>^v>>^^><>^^>v><v^>^<<<<vv<>^^^<<v<v>vv>v<<^v>^v<^><>><>><v><v^^v<><v>^v^<vv>v>v<v^v^<^^v^^^><^>v>>>>^>^><<>>^v^<v<<>>><vv<^^>v<v<<v^^v^^<^<<><vvv>^v^v<^v>v<>v<^^><v<><v<^^^<<><^^vv^>>^^^v<^>^<<^v^>^<<<vv<>vv<vv^^<<^v<>^<<^v<<v^v<>>vvvv<>v><vv^^><v<v<>^v^>><v<>^^^>^>^<v<v^^v<vv>vv>>^^>>v>>><^>^>>^>>v<><<<v^>v>^^<^^^v^>><vv^^v>>^v<^^^v>vv<><v^v^^^v<v^>v^>><^<vvvvvv><vv>^<v<v<^^>^>^>^^>>><^<v^>><<<><v^<^vv>^<^vv<<<<<^<vvv>^>^<^v<v<>v<<>v<vv<>>^<>vv<v^v<^>><<^<>v>>>><vv^^^^^^<<v<>v<^v^<^>v<>^^>>>^^^>>>^vv<><>^><vv^<^>^<>v><>v^>><>^<^<v>vv>>v>^>><><>^<^>><v^vv>v^<^^>v<<^v<<<>>^^>>^v<vvv<^>><^<>v>^v<^>v>^^>v>>vv^^<^v><v<^^^<^<>v<<v^^^^v<>>vv^<>><<>>vvv<v<<<^v<>^^<^^vvvv^>v>v^>>v><>>^^>v^v>vvv^v>^><>v^<v<v<v>>>vv^>>^<v<>>^^^v><<vv<v<>>^v^>vvv<vv^v<^v>>>^<<>^<<v<vv^^<^>v<vv^v^^v<^>v<^>^v<v<><>v^vv^v^^>^<v>^>v>^>v>^v>v<v<v^vv^>>>v><^vv>vv<^<^^^^><^vv<^vv^<^<^>v<>v<v<v^>^<>^>^<v^^v>>vv>^><vv<>^v>^>^v>>>^vvv><v<><<v<<v^vvv^^<v<>^<^v<>^<<^><v<v^vvv>>^v<><^><<<^^^^^v<><>>^v>v^>^<vv^<v^>^^v^v^^<<^<><>v><<v>^^<<^^^>^>>^<><v<<<v<^>>^>^<v>><<^^vv^>v^^><^><>>vv<><>>>vv<v<vv<^v><>^v<>^v>v<v<>v><v^^<vvv^v<<<>v^v<><>>^vv>^^<v>^<<^^<v>^<^v<^v>>>^<<^v>>^^<>><>><<^<<<vv<>^^^^v<v^^v<<<>^><^>>^<>>v^<>^>>><<^<>><^^>^><<v>>vv^<<v><^v>^<^<>><^^v<<^^^<^v>v>v>>v<<^^^<^^^>^>^<>^^^<^><^^v^^^^<><<v^v^^>vv^<<^<vv<>v>>>^vv>^^><^<><><<^<>>><<v>^><>><<<<^<>vv<^^^>^v^<<<<^<^><<^v^^vv>>^^<^<^<>^vv>v>vv>>>^<v<^^v^^v>v>>v><^<<v>^v>^>^>v>v^>v^v^^^>^<^><vv><<^>>v^<v><<><vvv<vv<<>>>v<v><^<<v<^>^><vvvvv^v<^<v^>^<<v^<<v^<vv>vv^>^><^>v<v<^<v>>>>>^<><<>>^<>^<v>^>v>v>^<><^><>v^v<<<><<^><v<<<vvv>>v<<<^^^v<<><^^<^^v>>>^<vv<^v>>>v>>^^^<^vvvv<^v>^><^v^<^^vv>v>>^^<v^<^^vvv>^^<><<v<v<v<><><vv^>>^<v><<><<><>v^v^<>^^<^^>>^^>v<^vv<<^v<>vv^<>^>vv>vv<v<><^<><vv><<>vvv^^>>>v>^^vvv<>^>>^^v^v<<>>vvv><>^<<^>^^^^<><^^<>v^>^^<v<vv<>v>>>v^<vv<vv>>vv<v^>><>>v>>^v>v<^<^<>>><>>>v<>vv>><v^<<^>v^<<><><<^<>v<<^^>>v>^>v^<^^v><v^^v^<>v<<<>^v^>v<>vvvvv<<>v^>^>^<<<vv<>vv>><v>><^^<>><^^>><>^^^<v><^<<v^>^<^<^vvv>>><vv><^^v>v^<>>^<>><<><<^<v<v^<<<<>^><^>^^v<^<^^<^^^^v>^^>^^vvv^<^^<^vv^^^>>v^>^<>v>>v<><><><<<vv>^v<^<^>><^>v^>v<<v^^v<^^>vv^^v<v>>^<<<^<>>v^>v<v<<^v>>>v>v^v>vv^^vv<<vv^>^vv^>^<vv>^>^^v^<v^v>v<^>v^<^>>^v<vv<^^^><>v<<^<^<v><>>v<v>^>^vv<^>>^^>v^>>v^^>^<<^^v^v<^<>>^v><>>^v<^v^^><v^>^><<<<<>><vv^<^>v>>^<^vvv<<>>vv<^<<><^v>vv>>v><v><v>^v^<^<<<^^v><><^v>^>vv>vv^<^v<^^<<v^v<<><>^>v<^<vvvv^<v>><v^<^^v<vvv^^vv><>^>><><v^^^<<v><>^vvv<>^<v^v<>vv><^^<v><<^v<^<^^v<<v^v<^<^^v^^v^^vv<v>><^^v^>^><^vvv>^^>v<vvvvv>v^>^^^>^v^^><^v>^^<<^^<v^>v<^<^v>v>v^v^v<v^>vvv^>^vv^vvvv>^v>^<<^<v<>^>><<^v^<><><v<<^<<^v><>v<v<vv<>^><v<^>>v<<^><v^v>vv>>><^<>^>>><<>^^>vv^<>^v>v<>>>>^^<^^v><>^>>^v<^^v^<<^^v>>^vv<^<^<>v<^<>v^vvvv><^vv<^v^v>><<^<<><<<<<>v^<v^^<vv^<>v><v<v^<v^<^^>^v<vvv>v<^v<^<^>^<vv>^>>^^^v>><<v>^^><<^v>><vv>v^>><<v^^v^><vv<<v^><<vv>><v^v^<<<<>><>v><<<>v^vvvvv><^vv>>^<<<>>v^v^>v>^^<<>v>v<v<v><>><^>^<v^<<<>>v^<<><^>^^<<>><<v^><<>v<>^<><^v^<<vv<^v<>><v^<>v<v^^><v>^v^>^>><v^>^<<v<<v<<v<v^<<v>><v>^vv<^vv^v><<<>vv<v^>v>^v^<>^<v^>><><^v<^v^<>v^<>>v^><^^>^<vvv<<><^>^>^>>^<v><^^>^^vv^<^v><>^v><v<^<^^<vvv>><><><<vv>^<^v^<vv^^<>><<^^>v^v^^<<^^v<v>^^<^>vv^^>^>^^<<v>>>^^<<v<>^>^<^^vvvv>^v<^v<>v>^>^v^>vvvvv<v<<>v>>><<^vv^v^<<vvvv<^>vv>^<>>>v<>>^^<<<<<v>v<>^v^vv^v^v><<>><>>^<^<v>>^v<v>^^^>^^^v>^v^^^^><<<^<v<<<<^<^v^^<>^>vv<^v>^>>^^^vv>v>>>>v<<>^><^><^<v<>>><v>vv>>v>^<>>^v>^v>>><v>v<>>^v<>^^^^>>^vvvvvv^^v<<<vv^<^<v^v^v>v<><>^v<<>>>vvv><v>vv>^^<<>>^<>^>^^>^^><^<<v<^^^^v^><v<><<>^><><<^v><<^^>^v<v><>>><^^>v^^>^^>^^v<^<>>v>^v^v>>^^vvv>>^^<>^^^v^^<><v<>>v^><>^^v<<^v<<v<>^v^<^<<<<<^^<<vv>>v>^>^><v^<<^v>v<><<><<v^^^v^<^^><^v^v<<^>^<^><v<v<^>^>>>^^^^^>v^<v<v<^v^>^<>v<^<v<^<<><v><^^<v^<>vvv^<<v^>v^^>vv^<^>>^^<^v^^^v<vv>^<>v<^^^>>>vv>^^^<^<<<^<v<<><v<>v>^>^v<<^>>>v>><<^^>vvv<>><>^><^>^<v<<v<<^^>^vvv>><>>v^>^<^<<v<v^>^^>>^>^>>^^<^v<<^>>>^^vv<^<vv<v>^><<v^>v><^v>^^v<^^v^>^><^v<<<<^<><v<>^<v<v><v<><<>>>v<>>>^^^vvvv^v<>^^v^<<<v^>^>>vv<^><^<^<v><^^vvv<v^^v^>>^>vvv>>>^>>>v>v><^>^<<<^^>^^^v<>>^<^>^>v^><>^^v<>^^v><<vvv^>vv>^^<v>^^<<<>>>v^>>^^<><>vv>vvv><<>^vv^^v>>^^^>>>>^<v><<v^^<^^^<>>><<v<^<^>v<<^^^vv^<<vv><>vv^v^>^^>v>v^^>^>v^><>v>v^v^<vv>v><<vv<v><vv>>><>^^v<^><<><<vvv>^<<<<v<^v<><^<>^vv^v>^<>>^v>^<<<><>><><<v<<>>^vv><><>>^^^>^v>v>vv^<<><^^><>><v<><<>v>vv^<v<<^<vvv<^>>><^vv^^^^vv<^vv^v^>>^v^<>>><<>^>>^^><^<^v>><>>><v^>vv>v^v>v^>>vvvv^<^<<vvvv><v><v><v<^v^<><^^v^^<<>^^^v>>v^^<v<>v^<<v><^><<>><<>^<v>^<v<vv><^<<vvv^<^<^^>^<vv^>v>><vv^>v>v^^v^>><<v^^v><vv><v<<<<^^^v<<^>>>^>^<^^^^v><>vv<vvv>v^v>>>>><^>^>>^>v<^v^^<v^v^v^>v^<>v^>v>><<<><<v>v>^^^v^>>^<>v<^^^^v<>><<^^<^<^<<v^><<><><vv>><>^<^v<<^^vvv<^vv>v^vv><^^^<><vv^<<vv^<>>^v<^>^<^^v^v>^v<^<vv^>>^^>v>v^<^>>v>v<>>>^>>>>vvv<<^vvvv>><v><^>v<^>v<>^v^<<<v<v<^vv>>^^^<<^<v^v>v<vv^^v^^<^v>v<<><^^<^>v>v>^^v<v<><>><^>><v^v<<<v<^^^^^^^<<>vv^<vvv^>>v^^><<<v^vv^v<^<vv>^<^>v>>vvv>><^>vv<v^<^^>>>^<<><<<<v>>><^v<<v<^><v^<v><<^vv^>>vv>v^^>v<vv<v^>v<^^^<><^>v><<^<v^v^v^^>vv<v<<v<^v>^^><^<v<<><<<^<<^v^v<v^>v<vv^v^>vv^^>^>vv^v<<<>>vv<^v^<^v^<<v^^>^<>^<>^>><v><^^vv<vvv>>^v<vv<<>v<^<<vvv>vv<vv>>v^^^v<^vvv>>>v<<>><>>^^vv<vv>^vvv^^v>v<<vvv<v>^<v^v^<v>>vvv><v><<^<v>>^<^>^^<v>^<v<^><vv^>v^v>v^^v^v>><v>^><<^^^vv><>^<^^v^>v^v<^><<<<^>>^>>^^^v>v><<><<>>>>><v<><<>v^vv>v<^<^<^><v><<>^^^^<v><v<v><<v<v<^vvv>>><>>^>^<^<^<v^^>v>^<^^^v>><<<v<<vv><>v<<<<^>^v^v^<v<>>^<v>vvv>><<^v><<>^v<^>^<><<<>^<^>^v<v^v<<>^<<^<<<v><^^<>>v<^>>><><^vv<^v^vvvv>>^^<>^<>^<<<<v^><>><vv<^^>>^^v>v>^^^<<vv<>>>><<^><^^^^>v^><^vvv<v>vv<v<<>>>>vv>v<^^>v^^^>v^>><^^<<^^<^<>^<^^v^v<>^<v<<<^v<v>>^^<>><<v><^^>>v<<<<^>^>>><v>^^<<^<v^>^<><>vv>vv<^>v<>>vvv<>vv<^^>vvv^v<v<>^<<vv^^>^>vvvv<<<v<>^>>><<^vv>^v^vv>vv^<vv>>><>v^>^<>v>>v>>^<>>v<^><vv<v<vv<^v<<^><<>v<<<<<>v>>>vv<^<<^<>^<^<>v<><^>v^<<^v>vv><>^v^^^vvv<>^^<<^<>^v^>^>v>^v^^^<<^^^><vv^<<>v^>><v>^<v<><>";

function horizon = moveElementsInHorizon(horizon)
    firstEmptyIdx = find(horizon == '.', 1);

    if(~(isempty(firstEmptyIdx)))
        firstWallIdx = find(horizon == '#', 1);

        if(firstEmptyIdx < firstWallIdx)
            horizon(firstEmptyIdx) = [];
            horizon = ['.', horizon];
        end
    end
end

function data = moveRight(data, robotPos)
    [robotPosRow, robotPosCol] = ind2sub(size(data), robotPos);
    horizon = data(robotPosRow, robotPosCol:end);
    horizon = moveElementsInHorizon(horizon);
    data(robotPosRow, robotPosCol:end) = horizon;
end

function data = moveLeft(data, robotPos)
    [robotPosRow, robotPosCol] = ind2sub(size(data), robotPos);
    horizon = data(robotPosRow, 1:robotPosCol);
    horizon = flip(horizon);
    horizon = moveElementsInHorizon(horizon);
    horizon = flip(horizon);
    data(robotPosRow, 1:robotPosCol) = horizon;
end

function data = moveUp(data, robotPos)
    [robotPosRow, robotPosCol] = ind2sub(size(data), robotPos);
    horizon = data(1:robotPosRow, robotPosCol);
    horizon = flip(transpose(horizon));
    horizon = moveElementsInHorizon(horizon);
    horizon = flip(transpose(horizon));
    data(1:robotPosRow, robotPosCol) = horizon;
end

function data = moveDown(data, robotPos)
    [robotPosRow, robotPosCol] = ind2sub(size(data), robotPos);
    horizon = data(robotPosRow:end, robotPosCol);
    horizon = transpose(horizon);
    horizon = moveElementsInHorizon(horizon);
    horizon = transpose(horizon);
    data(robotPosRow:end, robotPosCol) = horizon;
end

for ii = 1:numel(moves)
    robotPos = find(data == '@');

    if(moves(ii) == '>')
        data = moveRight(data, robotPos);
    end

    if(moves(ii) == '<')
        data = moveLeft(data, robotPos);
    end

    if(moves(ii) == '^')
        data = moveUp(data, robotPos);
    end

    if(moves(ii) == 'v')
        data = moveDown(data, robotPos);
    end
end

function result = computeGps(data, boxPos)
    [boxPosRow, boxPosCol] = ind2sub(size(data), boxPos);
    result = boxPosCol - 1 + 100*(boxPosRow - 1);
end

boxPos = find(data == 'O');
sum1 = 0;

for ii = 1:numel(boxPos)
    sum1+=computeGps(data, boxPos(ii));
end

sum1
% assert(1421727 == sum1);

clear all;

data = [
"##################################################";
"#...OO...#......O.O.#.....O...O.OO..#......O.O.OO#";
"#.#.....#.....O...#..O.....O......O.........#..O.#";
"###.OO....O..O..O..O...OO......O##..O.#.O...OO..O#";
"#OO.O.O...OO..O..........O...O.......OO...O.O##..#";
"#..OO.O....O.......O###.O.OO.O.O.......O...O#.OO.#";
"#.#OO.O.#....O............OOO............#.OO.OO.#";
"#.O#O.O......O...O.....##....OO.O..#..O..........#";
"#...O.O...O..O..#..O........O.....O..#O.OO.O..OO.#";
"#....O......O.OO#O..O....#.#O..O......OOO...O...O#";
"#.....O...O.O............OO..O#.O.....O.........O#";
"#..#.O.OO..OO...O....O....O...O.O..OO.O.O#.OOO...#";
"#.......O..#.OO.O..O..#.O##.##O.#O....O....O...O.#";
"#OO..##...#...#...OO.OO..O..#O...#....O....O.O...#";
"#O........#....#O.O.....#......O..O......#....O..#";
"#.O...OO.#O..O.#.....O...OO#..#.O.#.OO.OO........#";
"#OO#..OO....O......O..OO.O.#O.....#....O...OOO.O##";
"#O...O.OO.....O.......O....#.O......OOO..OO.#....#";
"#.O..........O.....#O...#O.O.OO....O.#....OO....##";
"#...O...O....O....O.#.O..O....O.#.OO.OO..OO......#";
"#.O#.OO.#..O..#......#..O..O...#..#O#..O..O..O.O.#";
"#.O..OO#O.........##....O...O.#O...OOO..O.O.O....#";
"#.O.OO#OO.O.O..O...#O#O...O.O.O..O.#O....O....O..#";
"#.#......O...#OO.OO....OO...O..O..OO.O#O.O.#.#O#.#";
"#............OO..O...O..@..........OO#........O..#";
"#...#...OOO.#......#...O....OO.O.O..##O..OO...OO.#";
"#....#...O.OOO...O..OO..OOOO#.O.OO.O...O..O......#";
"#....O..O#O..OOO..#..#....##OO..O...#O..O..O.OO..#";
"#..OOO..#..#.......O..O...###O........O#OO...O.#.#";
"##...O...###......O..OO.O.O..O...#OO..OOO.O.O..OO#";
"#..O....OOO....O.O.O.....#..O.O...........#..#OOO#";
"#.OO.OO#OO....O#.#.OO..O.O.OOO.O....#.#..OOOOO.O.#";
"#O.O...#......O.O....O......OOO.#.........#......#";
"#..........O...........O.O.O...O..O......OOO.O.#.#";
"#O##O.O.O....OO..OOOO...OO.OO...O.O..OOO...O#...O#";
"#.OO..OO.OOOOOO..........O..OO..#O.O...##....OOOO#";
"#.O#...O.O...O..........O.OO..#OO.O.O.#OO..O..O..#";
"#O..#....O....OOO...#.#..O..O#O...O.......#O..##.#";
"#.O.O..O#OO........O.....O.O.#.O.OO.O...O...#...##";
"#..#...O.O.......OO.......O.#..O.....OO..#.O....##";
"#...O....OO.O...O.....O.........#.....#.OO.O..O..#";
"##.......O.O#..O......O.O........O.....#..O.....O#";
"#...#O.O.#O...O...O.O.....O...O..O...O..OO.O#.#..#";
"#.#O..#.O...#OO........O.......O............#.O..#";
"#..OOO..OO....OOO........#...........OO....O..O..#";
"###.OO....O.....#...O...#....O.....OO.#......##..#";
"#.O#O.....OO#.O....#.O.O..#.O....O.###...O..#....#";
"#..OO.O#.......#.O.OO.O...O.#OOO..........O...O..#";
"#....O..O..........O....##O..#...O....#.O..O.....#";
"##################################################"
];
moves = "^><v^>v>vv>v^>v>>v^^>v^^<>^^^^v^><>vvvvv^^v<^><^<v>>>^^<><v^v><<v^v>><><v<<<^vvv^<^^v^<vv<v>^>^<<v<v^^<^<^vv<>v<>^>^v^<<>>>v<^^^>>>^<v<vv<>^><>^v<<vv>^^>^v^vv<>v^v^^^vvv^<v^<>v^^<vvv>>^<^>^<>v^<<v<>^^>v<>^>v^<<<vv<<>><<<<^vvvv>v>^^<v<^>v<<<^v^vvv^>>vv>^<vv><<<><<^<vv>>^v^>^^>^^>>>v<>><<<<v^v>v^^<>^>^>>^><^^><>v<<>>^^^v^^<^<<^<v>>>>>^<><<>^^<^>^v^>v<>v<<^v<<<vv>><>>^^<v><^>^<<>>>^v<>^<^<^>><v<^<^^vv<<><^v>>>>>v^^<<v<^v>vvvv><vv^^^vvv<v^v>>^<<v>><>v>v^^^<v^^<^>^<>vv<>^<>><>^>v>>v^vvv>v>^>v>^^>^^>v^<<<^>v>^v>>v<^vv^^^^><><<><^^>v<<vvv^v<vv>^<>>v^v<<>vv<^^<v^>>^vv>v^^<>^>^^>v>^>>>^<<^^<^^^^^<v>>^>>v<^<vv>v>v><^<^>><^v<v>><<^<>>v^>>v^v>>>v>^>^^><^<^<<<^<v>><><vv^>v>^<^v^^^^<>vvv<v<><v<>v<v<>v><><><<v^v^^>>^v^>>>^<>>v>>^v^^<<^^>^<v><^^^^<v>>^>>^^^v<^^^<>^^<<^^^<^v<v^^>>^<v>^^<><v^<><>^<v<>^>^>>>^vv^^v^<^>>v<^vvv>>v^^vv<vv^vv<>><^v>v>^<vv^>^^^v^<<v^>>>^<^^v<v>^<<><>><^^^v>><^^vvvv><^v<>^vv<>><^>^>>v>>^v>^^<><>v>>^<v>>^v<^<v>v><^<v><v>v>>^<<vv><^v<><^<v><^<v>^<<<<^^v<^<><<v>v<<v><v^<<<v<^vv>vv<><v^<^^^>>><<<<v>v<v>^^^<^v<v<^vv^<v<>>><vvv>>v<^>^^^<v>^^>>>v<^vvv<v^v>v>><><vv<<>v^v^<^>v^<<<>><vvv>^^v^>v<vv^v>vv>>^<>^>>^><<>v><vvvv><^>><^><<^v^<^^vv<<v^>v<<>><<vv><v^vvv^<<><<<v<<<v^^^^>><><vvv^v>>^v<<>>>vv^v^^^>>^^^><^><<>v^>^<<<v<>v<<^>>>^v>^<v^vv<>^<>^><<<<^>^v^^<^^v><<<><<^v^v<v<<<^>>vv>vv<vv^>>v<^>^><<<^vv>^><v^<<v<<><>>^>v<><<><><<>>^^>v^>^^^v>>>>><^^>v<vv>^><><vv^vv^>^>>>><^>^vv^^<>>^vv>>>vvv>v^><<>vvv^v^<<<^vv>v<v<<<<>^v^><>>>v<^^<vv<^v^<><>>^v<^vv^<<>>>v<v>v^vv><>^^>>vv^v<<v^^<^>v>^<^<>^>v^^>>vvv^<>>>vv>vv<v<v^<<>v><^<><><v^^^v><>^v^<v^v<><v>^vv><>^>^<v^<v>^v^>>>>><vv^v><^^>vv<><^<^>^v>^<<<^^>v>>v>><>>^<v>^<<^<<>>^<>>v><^v>>>^^^v<^^^^v<><>vv<^>>v<v^>>>>>v<v><>>^^v<^^^>>^v>^v<v<v>>^v<><<<^v><<^^><^^><<>^<v<^^v>v><<^<v<v^>vvvv<^^^<<<^^>v^<<<vv><>v<<<^>><<^<><v^>vv>>v<^><<<>>^v>^<^<vv<>v^v<vvv^<>^>v^<><>^v>^^^>^^<><<><^>^vvv^>>>^v>^v><vv<^v^^v>>><^^>>vv^<><^>><<v^v^>v><<<vv<<><><<v^<^<<>>v^^^<v^^<<^v>v>v^v>>v<<>v^^>>><<<^>><v^^^^>>vv><^<vvv<v<>^><v<>vv<><^<><vvv>v^^>v<<vv^v><^v><^^>vv>><<v>>v<^^<v^^<vv<v<<>>>vv^v^<<vvvv>^^v^^v<^>>v>^<<^v<v>>vvv<vv^<<v^>>^>^v<v>^><^<v^v<<v<<^<<<<<>v>^><<>^v^^<^v>^<^vv<^<^<v^>><v>>>>><^<v^>^>^>>v><^>>><<^<>vv^v>vvv<v<^^<>>v^>vv<v<^<^>v^<<^v^>><<^v^<><<^>>v<<v^^<><^v^<><<>^vv><>>>>>><^<v^^v^v>v^vv<v<><<^<>v>vvvv^v<^>>^v<>>>>v^<<>><>vv><>v>v<<>^v^>>vv>v<vv^v^vv><v>^>>>>>>^^>^^>v^^<^^>>>^>^<><^>^v>><>v>^v^^vv^><>v>>>v<><<<<<<><v^><v<^>>^<v>>v^v>v^v><vv^<<v^><><><>vv^>^>vv^v^<>>>vvv<v^><^v^>^<<><^>^v^<^>^>><<<<>v<vv<^v^><v<<^<>^>^v^<<v<><<<^vv><<v<<v>^<vv<v>v^^^vv<<v<^>>v<v<^<v>^>><^^<vv<>><><vv<^v><>><^v<^^vvvv>^>><<v^v<v>>^>^<<>>^^vv^vv>>v^<>^<^<>^v<^vv^^<><^^>>>vv>v^^^^^v^<>><vv><<<<^<^v<<>>^<><^<<^><^^<v>^^>v<v>^>>vv^><^>^><>v^>>v<<>v>vv^v>^v>>^v<vv<^^^^<<^>>^<^v<^vv>^^><>v<<^^^><v>vv^<vv^vv^v<<^vv>>v<>v>^v^>>^^v<<v^<<^vvv<v>><v^vv^^v<<^<><><<v<^<>>>vv<v>>v<><^<v^vv<v^v<^<>^^^<>^^>^^^^^v<>>>^<>^>v>v>v<v>^v<><^<v<v>vv<v<>v>>vv<>^>^><v><vv^>>vv<v<<^v>v><><v>v<<vv>v^<v^><^<>v<^<vvv><><^v><^vv>^>^v<><>vv^^<<v><v>^<^^v>>v<vv>vv^^^<<>v^<^^><>>>><^<^^v<<^<><^^^>>v^><^^^^v<^v>v>vv>>><<^^^><>v>^^><vvv<><<^<><v^>^^><>><v^>><^v^<>v<v><<>v>>^><vvvv^>v>>v^<v^<vv<<^v^v^>>^v^<<vv><vvvv^^vv<^><><><^^vv^<><^<^<v>>^v<<<<<vv<<v<<>v>v^<<^<vv<>v>v<^v>>v^>vv<^^v^^v>^v>^^<><^v>^<v<vv<^v<v><v<^>vv^<><v^><v^<v^>^vv<<><<vvv<vv^>>><^<v>><^<^^^>>^^^^><<<<v^v^<<^^>v<v>v>^<>^>><v<<<^<>^^<v^<v<><>^<^>vv>^><>>vvv<v<^^v<^><^^^^^<<<<v<^v>>^>>^>v<<^vv><v^^^>^<<<v^v<>^>>>v>vv>v^v^v>vv><<<<^<^v<^v><<<<<vv<>^v>><<<^^vv>>>>v>v<v>^><v><v^><<<v<>^^vv<v^<v>^vv><^<>><<^^><^>vv>>v>><><^^^^^^v>^^^><v^^><v><<><<>^v<>>v>>v<v<>v^>^<^^<<^v<^<>><vv>v<>v>v^<>v^>v<v^^vvv<^vv^^><^>>^v>^>^>vvv<^^v>^^^><>v>^^>^<<vvv<<^<><<>><<>>^v^^>>v>>>vvvv<<^>>vv>v^><vv><>><v<<>v^v^>vvv<>^v>vv>v^>^v<v<v>v>^<<><>^><^><>^vv><><<^v<>v^<^<vv^><v<vvvv^^><v<>^>^v^^^v<>><<><^v>v<<>^<<<^^vv^>^>vv<^^^^v>^^^^v>>^>v<>>>^<<<^<^>^^v^^<^^v<v><<<v<>v<v^^^vv^><vvv^><vv>>v^v<^v<>v><v>v^<v^>v^v<<vv><>>v>v>>v^>^^<v<<v<^v><<v>>>^^vv<>vv^<^v<^^>v>>><>>^>>><<v<<^<^>v^^<v^v<^vv<<^v<^<>>^^v^v><v>^<<^<<^<v>>v>><^>v>^^<><v<v>><v>vv^^v<^^<v<<<<>^^^v^^><<>><^^<v<>^>v>><><^^<<><^^<^<v>v<>vv<v>vvv^>^^vv><^<^^^^<^>^>>v>v<v><^<<vv<>^^^><>>>><^>^<>^>^^<^><<v^>^<^>^v<<v<<>v>>^vv>>^<<vv>vvv><>v<<^^<v^v>>^><v<v^v<>^^vv>^^^<<><^vv>^>^v^>^<>^<^>>><v<<<<vv><v^v<^^<^>^>^>v>><vv>>^><<^^vv^v<><^v>^<v>^>^^vv^<v^>>^^^<^v<v<>v><>><<<^<v<<^<>><v<>v^v<>^^<><>^v<v>^^vv>^v<>>^^>>>v<>vvvv<vvv>v^<^<vvv>>v^v^v<<^>>^<<>vv<<^^^^^>^><v<vv^vv>>v<^vv>vv^<v<>>v^v^v<v<<^^v^<^<>>v>v><<<<>>v<>v<^><vv>^^v><^<v<<^vv>><^<>>>^^vv<>v^<^^<><<v>^vvvv<^v><^<v<v<^<v><<^<v><^><<v<<v>v^v<^<>v>v^^><>>^^<^v>>^>^^v>v^><v^v><>v^<^<v>>v^^>^><^^<^<vv<<>^<^><>>>><<^>>v<><>>>>>v^vv><>v^>><v^<^v<^>><<^<vv<^<<<<>^<>^<<v>><>^<^>^>>v^v><^<vvv^^^^<v<<>>><v>v^<>^^^<v><><^^<<v>^vv<>>^>^>><v^<<<v<vv><^<^>vv<>v<>^<>^><<><<vv<<<<<^<^<<<^>>^vv^><^><v<^vv<vv<^v^><v<<^<><<vvv<>>>>v>v>><v^^>^vv<<<v><^^^v^^<^<>v<v<^^<^^>^>^^>>>><<<>>^^v>^v><v><<v^v>>^vv>^^<v>^^v^<^^vv<^v>vv^<^^^^<>>><^<^>v<v^>^<<vv^>^^<vvv>>>>^<>vv><<<>>v>^<v>>>^<v^<v<>v>>>v^^>v>^>^<><<^v<>v>v^v^>v^^><>v<<>^><<>v^<v^vv<>^v^^^>>^<<v^v^v<>^>^>^^<<<v><^><v^>>>^^<<>^<^>>^^vv<v^vv^<>>v^<<<vv<>^<<^<vv^vv>vvv><>v^^<v<>v>^<^<<>>^>^^><><>vvvv><>^v>v<v<<>^<>v^><>^<^^>>>>^>>^><^v>>><>v^^<^<v>^v^><^>^vv>^v^>^v<v<><<>^>>^>v>^^>v><v>>>v^><<v<^<<v<<<>v<<>^<vv>v^vvvvv^v>^v<^vvv<>^>^^^v^v<^<^v>>vvv^<><v>>>><<<>>v>>^^^>>v><<<vv>v^>>>>vvv<>vv^v<^^<>^v<v>>^>v<<>^^>^v>>^^v^vvv><>v^<>v>v^>>v<^>^^>v<<>vv><v<v><^v^><^v^^>^<v^^v<<>^<v><>^vv<v<v><<<<>^^>v^<<<<^><v^^^<>>><<^<^>v>v^><><v<^>><>vv<v^<<>><<v<v<^><<v<^>^v>^v>>^v<v><<^><>>v^<<<^>>^<>>>vv^>><^<v<vv<>^^v<><^<^><<><<v>v^><v>><v^^<v<^<<<>>^<>>v>v>^<<^^v<<<<<v<v^^v^<<^^<><^v>>^<v><>>^>^<>^<^>>^^^v<<^v>^v><^<v>>^v^><v<>vvv^vv^<<v>>v^>>v<>>^^^>v><<^v^><<>><v>><^<><^<^v^vv<<^>>v<v^<^^<<>^>v^>v^>>>v><><><vv<<<>>><<v<>^><^>>v>>>><<v<<<>vvv<>v>v><v<v^>v^v^<^v>vvv<^<^^>^v^<^^<<vv>^^<v^^v^<^>^>^^><<<<^<<<>><^^>>>^^<>>^<v><>^<>>^<><^>^<^><<>^<>v<>>>v^>^>^^<^>^^<vvv>><<<<^>vv^v^>vvv<<<<<>^v>>v>>^<^><^vvv<<>vv<v>^<v<v<><^^>^><<v><^>v><^<^^v^^<v<>v>^><<>^v^<^<^vv><v<<^v<><>^^^^v>><<^v>vvvv>^^<^>v>>>v^<<v<>><>v><>><>v<<<<<<<>>><v^<><><>^>^^<v<v^>^^^>>v^<<^<<v^<<<v<^<v><<>vv<<>v<<>v^v>>>^>^vv^<<vvv^<><><^><^>v<>^>^<^><<v<^v>>^<>>v^v^<^^>v^v<>>vv<<^><<v^<v<^<v^^^^^>>>^><<<<>v>><^v>v>^^vv>v<^>>>>>>>vv>v>^>^<<^v<><^>>vv<^v<v><<<>>v<<><v>>v^<^<>>^v>v><<^>>><v<<v^^<<^vv<<^>v^v><v><<v<^v<<>>^vv<<>vv><^^>^<v>>>v>^><v^>^>^>><>v<<>v>^v<<<>^>>v<>v^><^^<^<<<^<>^<<<>^>v^>v<><>vv^<v^^>^>v>vvv>v<v^>^>v<^>^>^><<v^^>>v<v>^<<>>v>v<>^^v^v^<<>>>^^^^^vvv^>>v^<>>v^v<^<^^vv><vvv>^<^<<^><>>^<v>^<><<<vvv<<^v<<v^<<><^>><^v^v<<<><>v<v^^>v^>^>><>^><v^vvv<><>v>><v><><>^v>>v>vvv^^<<>>vvv^>>^^v><<vv<><>>^v<^>^<^><^vv>^v>>><<<v<^<>>v^<<<^>vv<v><>^v^<v^v<v<vv<vvv>>^>vv^vv<<<<vv^^^v^^><<vv^<v<^<v>^^><v^^<v^^><v<v^>>vv>><v>vv<^vvv^<v^vvv<v<>^>><^>vvv^<v^v>^^>>>^^>>^<<<v<<^^><<^v<<^<<<><>v^^<^v^>^vvv<^^^>^><^^v>v<>><^>><v<v^v<>vv>>v>^<<<^<>^v<>>v^v>^>v^vv>v><v>vvv^vv^^<^v>v>v>^<^vv<v^>v^>>v<v^<^<v<>>^><>^^v><<<vv<v<v><^<>>v><<<<^^v>>>^^<^v>^>><^<^<^<<^v^v<<>>v^v^^^<v<<v<v>v<v>vvv^><>^v<^<v>v<v<^>v^^^><<^v^<<><^^vv<^>v^<^^>vv<v<^vv^^^<<>v^<^<<^^><<^^><^v^>>vv^v><v>^<^<v^v<v>>>^^<>vv<v<vv^<><<>>>>v<^<v^><><v^>^^vv<<^v<<<v^^<<><v<>^>><^v^<<>^v>>^<<^>v<^>^^>>^>^v<<v^^<>^^^v^<^v>><^<v^<v^<<v>><<<^>v^>><><vv<>v^^^^<vv<<v>^^v<>^^<v<<<><^v<^^vvv><<>>^>^^>>><<<>^>vvv^>^<^^<vv^v^<^^v<^v<^<v<>>>^vv<v><vvv^><v<>v<^^^^v<>>v^v<^^<v><v<<<v>^<>^^<^v><<v^^><^v^v<<^^><><v<^<<^<><^^><><^vv<^>vv<^^<vv^^v^>v>>v>><v^<>vvv>^>v^^><<<><vv<v>^<^v^^<^<>^v<^>vv<vv>vvv>><><>^<v>^vv><^v<^<^^vvv<<^<v<v>v^>>^v>v^^^<^v^>v^vv<<^vv<^>>vv<<>>^>^<^>^>^vv<<^^<^<v^<^>v^<<<^<^vv>^^^^v<vv<<>><v^vvv><>v^^<>^>v<>>v>vvv><>v<^><^<vv>v><vv>>>vvv<v<>v<^v<>><^^^<v>>^vv>^<v^<<<v>^<v^^v<<><<^v>vv>v<v<<<<<>^^^>vv<<>vvvv<>vv^^>vv^<<vv<><^<vv<v<^<><v>v<vv><^^^vv>>v^^><<v<vvvv<^<v^>^><^^<>vv<^^^<^<<vv>^>vv^>><<<>v><v^>>v^vv<^v^v<>^<>vv^v>v>v>^^<>^^><v<<^<<<<<><>v>^^>>^vv<><v^^v>^^>v^<<v<^><>><^<<v><^>><<v<<^^v>^<v<^<v^^^vv^^<v>^<^<v^>>>><vv>><^<<vv^<<v<<v<vv>><^<<><>v^^^>^^><<^<^^><^vv><><>>vv>^^^<<><<>v^^v^>^v^v><^>^^>>>vv<^v<^^v<^^^>>>vvvv>>^v<vv<v^<^^>>>^>vvvv>v<>>^^v>v>>^^^<^^^>>>^<^>v>v<vv<^^<v>>><>^>v^^>^<<v><^^>><v^><v><>><<>>^^<><^^v^<>^>^>>><v>>>v<>v>^^vv>v^vv^^<<^v^>vv<^<^><^>v^>v^^^>^^<<v>vv>><vv^<<v^v^vv<<v><v^^v<^<vv>^^^<<>>^<^v^<<^<vvv^v>v<v<>^>vvv^^^<v>>>^>><<<^v^<^^>><<^<>v>v^<<v<>v><><v<v<^vv<<vv<<<v>^v<^^<>v^v^^<<<>^vv><v>v<<^v<^^v^v^><<<<^^^^>^<>>>vv<>><^v^v<v^^>^^<^^>v^<vv<^>vv^^>v>>>v>v^^^v^vvvv>>vv^<<^<v>^^^v<<><v^>^v>>vv>^v>v^^^^^^^v<><v^v^v>v<v^<^>^^<<<^v>^^v^vv>vv>>>^>>^<>v<v^><v>>><<^^><>^>^^><v^v^^v<v^>v<^<<<>>>v<>>^<^v>>v^^^^<v<^^>>v^>v^<^^v><^<><>>^>^^^vv^^<vv><v>vv^^<^>^^><<>v<>^v^v>><vvvv<^>v<><>^v<^^><v<vv<<<^^v<>><<^^>>^>v>v<>v^^^>^^^><><>vv^v><>v<<v^^v<><v>v^^<<vv<^^<^v^v^><<^<vv^v<<>>^<vv^>v><v<>v^^v<>><^><^>>^>^<>v>^v^><>^<v<>>v>>v<>>^<>v^^<^v>^>^^^>v<^<^>^vv><<v^vv>>^>v>vvv>><<^><^v>^>v<^>v^><<>v>>^^>>>^>vvv<^><vvv>v^^>><v^>><^v<<<<vv>v>v<<v<<><>^^><^<>v>>v><v><^vv^<>v<>><v^v>>v^<vvv<^v>^^^<>^>^^v<^^^^^^<<v>v>v^^v<<>^^^^<^<<^>^><<vv><v>>v>>^><^<vv^<^<>>^>^^^v>v^<<v^^<v>>v>v><vv^<v<v^>v^><vvvv<v>vv>>>v><<>vv><>v^v><<^v>>^>v>vv<v>v<^v>v><v>^>>>^v^^<<<vv><^<v>vv<v<>^>v>>^v<vv^v>v>v<vv^v^>><^v>^>^^>v^v<<>>v<<>v^<<>v<<>vv>v>v<><v>>v^vv^>^^^vv^>v^^>><v><^<^vv>v>><v<><v><^>>^<>^v^<<><<><v>vv^<>vv^<<<v^v<^<v^>v<^<v^v^>^^>^^v^vvv^>v>v^>vv><><><>vvv><v<v<v<>vv^><>^<v^v<<vvv^v^>>v^v^v<v^<v^<>><v>v^^<^<<>vv>vvv^^<<>^><^^vvvv><v^<v^v^v<<<>^<v^v<<^v<vvvv^>>^^<vv>v^>^^^><v>>^v<^^<^<>v>>v>^v>>v><^^v^<^v><>v<><<<>^>v^^v><<v<v<<<^<vv<><^>^<>>v>^>vvv^<v>>^<v><v<^^^v>^^v>>^>^v^>>>^v^>>^v<<<>>^v^<^v>v<v<>^^>^>^<^v^vvvv><^><>^v^^<^^<^<>v^v>^v^>>^<>^>^^v<vv^>^^v>v^v>>vv<<<^>>^>v^^<>^<vv^<>>^v>v^><<<>v<v<v^>^^vvv^^^><^^^v>^<<<<^^>^v><^>^^^>><>vv^<^>><^^<vv^v<v>>>^>>><<<>^v<<^^><>v^^v<>><>^v<<v^^<<v^><^^v^<vv>^<v>>v^>v^>>v^<vv^>>><v>vv<^<>v<v<^^v<^<<<><<^<<v^^<^>>>>^v^>^^^^vv^v^>^>>>>><>>^>>^v>^>>^>^v^v>><v^<v<^>v<^><^v<v>v<>>^vv^vv<>>^vvv<<<^<<v^<vv<<v>>>v>><vv<>v^<^><<>vv<<v<^^v<vv^<>^<><^>>v<<^^v<v^<<><>v<><^^<<><><>>v^v<<vvvv^v^>v<<^v^v<vv><><v^>>^>^v^<^^vv>^v^v<v><>>v>v^v>^<v>>><<^>^^<>>v>^><v>^<>^>^^>><>^<>>vv>v<<<>>^<^<vv^v^<v^^^v<<>v><>v^<>^<^^>v>>v^><<>v^<v^><^^>vv<>>^vv<<<^>^><^>>>^<^>>^^v^v^<^^^<v<<v>>><vv>>>><<^<<<vv<^v>v^><>^<>>v>^^^<^^<^>>><^<v<>v<<<v^<<>v^^>>^vv>^v>^>^<><<^^^<v>vv>^<>v^^<<v^vvvv>v^<^<><<^v^><>><>^v^<v^><vvv^><>^><^v<v><v^^^<v>^>vv<<<^><<>>^><^>^^>vv<>v<<<v^v>>^><^vvv>><v^v^^>><<<<>^>^>^v<<><v>>v<>v^<^v^v^>>>v>^<v><<<><^^v^^^v><><>>v>>>^><>^vv^vv>>v>v<<<^<^<<^<^<^^v^<v>>^^<v^<<v><^^vv<>v^v<<v^>v^<^>v>>^^v^v^<v>><^v<<^^<<<^>^<v^^v^<vv<^>vv<>vvv^vv^<><<^v><<<v^<><^<vv>vv<<v<vv^<<v^>^<<<^v>v><<v>>v>vvv<v>v<><^<^<>^<<^vv^v<^^<<><^>><vv^^>><^>^>^^>vv<<>^<<>vv>>>>><>>>^^>>^<><>^v>^>><><^v^<>^vv<>v<v<^^>^vv>^^^v<v>>>>>^>^v><^<<^>>v^^v<<<v^^>^^>v^<^<>v<<^^^vvv><^>^<v<vv^><>>>^<<v><><^>^^^>v<><^v>>v<v><<^v>><<<v^<<v<>vvv>v<>vv><vvvv>v>^<<^<vvv^<<<>v<<v><vv^^<<vv^v><^^^<^<^v>v>><v<>>><<v^^>^vv>^>vv^><^<<^^<<>v>^<>>v^<<<^>^<^><v<^>>^<>v><^<>>v<v<>v^>v^<^^v<<<v<^^<v<^^v^<vvvv^vv>>>>>^^>v^^<><<<v>^<>^<v><<<<v>>v^<v^^^><><><v>><<>vv^><^v<><<^^vv<>^v>^vv^vv^^>><>v<^<v<v^><><v^v>^vv>v<<><<^<vv<^^v<><^<>>><^^^<^^v<<<<^<<v^^v>>>^<v^^vv<>>>><>vv>>^<>>^v><><<^<<<^<>><^^<^<<>>>v^v<<<<>v^>^<>^v>vv><>>^<v>><>^^v^>v<<v<^<<>>>^<v><<<>^<<<^^^<<><>>v><><^v>^>^>^<v>v>^v<>v>^^v^<>vv>v>^><^^^v<v<<>v>^>^>vv^<>v>>v>>>^><^v<>^^<^<<v<v><^>v>^v<v^>^>vv^^^^<<^<<^v<v<vv>^v^><<<^<<<>>v>^<>^<>v^^v>^<^v>^v^^>^<v>>^v>v<^v>>^v^vvv<<^^<^^>^>^>^><>^<>v>^v<><<vv^^>^^>v>^v^v<^>>^^^><v>>^<v><>>^>^>>vv><>v><<^><>v><><>v<>^^<>>v>^>^v><v^v<<>vv^>>v><<v>>^><^<^><<^v<>>^<v^<^<v>^v<v>><^^^>>>>v^^v>^^>^<v<<vv>v^<^><^>vv<v>^v>v<^<>v<><<<v<vvv^v<<v<vv^vv<^<v<v<v>>^v<^vv>>>>><v<<^>>^<><v^<^<<<>><<<>^vvv^<^>>v>>v^v^vvv>^>>>^^<>><<<>^<><^>^v<vv>>v<vvv^<>v>v^v<^>>>v^vv<<><<v>><v<>>vv>>^^>>>>^<v^v><><>><vv>>v^^vv>^v<<<vv<^<v>>^<^<v<<>><>v<>^>^<>v<^^>>^>vv>v^v<<vvv><v^v><v<v^^^>>>v^<<<^>^<vv<^<>^>v>><>^<^>vv^vvvv^^><^v>>>^>^<>v>>^^>vv^v^^><>v>^<>>^>^>^v<^<<><<>^^<^<vv^vv<^v>vv<<><^^<<<v<>vv>v^><<<<<>>>^>^<<^<<>v^^>>^>v<^>v^<>>>>v^v^^v<<<<v>><^>^><^<v^<<^^^>vv>><>>v^v>><^v^^^^<^v<<<^^><^>>v^^<^^v<v<v<v^<v><><v<^>>^^<<><<<^^<>>>>>^<^v<<<^v>v>vv<v^<vv^<><^v<>>v^^>vvv^<vv^^vv<v><<v<<^<>>v<>v<v^^<vvv>vv>><<^v<>>^><<vv^^<>v^<><>v^vv>>^<><<^><vvv>vv>>>^^>v>^v>^>v<<>vvv^<<^v^>>><<v<v^vvv^<v^^>>>><v^v^<v^>v^^>^v>v^<>v<>v<>><<^^<<>v>><>^^>vv^^>>>>>^<v^^^v^^>>><v^^<v>^^v<<vv<>><<v><^<>v<^>^^<^<v^<>v><^^^^>>v<v<v>^v^<^<^^v<^>>^<^^^>^^^^^>^<^v^v><>>vv^>vvv^<vv>^<><v<<>><^v^>><<^v<^<>^<v>^>^v<^>vvvv^^>^^v>v^v>v^vv^>vv^^<vv^^v<><^<^<v<><>vv><^v<v>^vvv<>>v^>^^^><<^><<v<vv>vv^<>v^v>v^<<>vv>>^v<^>^>v^vv<^<>>><^<>^><>^><^^^>>v^vv<<>v^<>v<<vvv<><^^>>vv^><^>>v^vvvv^^v>>>v><<>vv<^v^^^>v<v^<v<^>^^<<<v^<^>^<>>^vv>^><v^^^>^<>>>^v<>><v<><v<^v<><^^^<<>vv><>^^<>v>>>>v><^v<>vv^>^vvv^<v>^^>^v>v<v>^^^^>v^v<<v^vvv<^^>^^>^<>^>>v^>^<>>^^^^>v^^^^>v>^>>v^^>>^>>>^<>^>><><<v<vv<^<v<^<^>v><^<><vv^>>>v<<>^v^vv^^v>^vv>>v^<>^^<v><^<<<vvvvv><>>v<<>><vv<vv^vv^^v^><v^v>>^><>v<<<v<<>><^v>>>^<^>v^^<<^^<<^>><^v^v><<<^<^<>>v^<>v>^>v>^^v<>vv<^vv<v^><vv>v^>^vv>>vvv<<v^v<<>>><<>^<>>v^v><>v^>^>>^vvvvv><v>v<<>^^v><^><^^><>v>v>><^>^v<>v>><^<><<><v^^<>>v>>>v<^<<^^>^v>v^>^>v>^>>><v<^vv^>v>>>^^>>^v^>>>>v^^>vv<><^<^<^vv^vv<>vv<vvv^^^vv><>>v^><<^vv<<>vv>>^vvv^vv^<>^<v>^^<>v<vv<<v<v><v<^^<^v>^><<^>v>v><v^vv<<<vv>vvv^v>v<<vvvv<>>>>v<<v^><^<v<>^v^>vvv>^v^>v>>><>^<<<vv<>v^vv^>>>v>^vv^<><<<><vv^>^v<>v<v>v^^<vvv<<><v^<^>^<^^^v>^vv>^v^><>^<v<^^^>>>^<<v><v^<>>v>>>v<<vv^<vvv>^vvv>v^v>^vv>^vv<^^>vv^vv<<^<<>>>v<v>>^^v<^v^>^>v<^><v^><><><<vv^v<v<>v>^<><v^<v>><v<v<<<v>>>>vv>>>v<>>^^vv^<<>>>>><^<^<>^<^>vv>^^vv<v>v^<><vv^>>>vv^<>^<>^vv<><>>>>^v<>v<v<^<^v^v^><<>>v<^^^>>>>>v>><^v^v^^^<v<>vv>><^v<v^<>v<v^v<^>><v<<^^<<^<^^v<<v<v>^^^<<v>^<v<<^v><<^>^<>^>>>^^v>vvv^<<^><^<^<<<>v<><v><^v^<>v<^^^^^<^<<<^<>v^v^<v>>><>^^v^^<<>v>vv>v>v<v<<<>^v>^>>v<^^<vv^>><>v<>v>>>^vv^^>v^><>^^vv^vv>v<^<><^<<vv^><<><>>^><^v>><>>v>v<<^vvvv^^^<^<^^^<^><v>>v>^v^^v>^v^vvv>^>^v^vv<>>>>^<v<<^^>>vv><v<v<vv^v^v<><<><v<<<<<^<^vv>v^^<>><vv<>v<<><^<<>^v><v<<>>><>vv>><<vvv>><^^<<vv^<v<<^>v<v>vv<<<>>>v><^v>v^><^vv^>><>^<<<<^vvvv^^><^^v^^<v<v<<v>^^>v<<<^<<<>vv>^v^<<>>>>>v<>^<v<^<>>v<vv>^<<v<^^<<vv>^<<>^^>^>^^>>v<v>^^v<>>><^v>^v^^><>^>^>^^vv^>^v>v^<v^vv<<v<vv<<<v>vv><v<><v<>^vvv<^v^v^^^<>>>>>^vv^^<^>^>>v>^<<<vv^vv>^v<><^<>^>>^^^<^^^^^>><v^v<^vv^<<^vv^>^v^vv>^>>^^<><v>>>><v^vvv^<^>^>v>>^v>>^^><>^^>v><v^>^<<<<vv<>^^^<<v<v>vv>v<<^v>^v<^><>><>><v><v^^v<><v>^v^<vv>v>v<v^v^<^^v^^^><^>v>>>>^>^><<>>^v^<v<<>>><vv<^^>v<v<<v^^v^^<^<<><vvv>^v^v<^v>v<>v<^^><v<><v<^^^<<><^^vv^>>^^^v<^>^<<^v^>^<<<vv<>vv<vv^^<<^v<>^<<^v<<v^v<>>vvvv<>v><vv^^><v<v<>^v^>><v<>^^^>^>^<v<v^^v<vv>vv>>^^>>v>>><^>^>>^>>v<><<<v^>v>^^<^^^v^>><vv^^v>>^v<^^^v>vv<><v^v^^^v<v^>v^>><^<vvvvvv><vv>^<v<v<^^>^>^>^^>>><^<v^>><<<><v^<^vv>^<^vv<<<<<^<vvv>^>^<^v<v<>v<<>v<vv<>>^<>vv<v^v<^>><<^<>v>>>><vv^^^^^^<<v<>v<^v^<^>v<>^^>>>^^^>>>^vv<><>^><vv^<^>^<>v><>v^>><>^<^<v>vv>>v>^>><><>^<^>><v^vv>v^<^^>v<<^v<<<>>^^>>^v<vvv<^>><^<>v>^v<^>v>^^>v>>vv^^<^v><v<^^^<^<>v<<v^^^^v<>>vv^<>><<>>vvv<v<<<^v<>^^<^^vvvv^>v>v^>>v><>>^^>v^v>vvv^v>^><>v^<v<v<v>>>vv^>>^<v<>>^^^v><<vv<v<>>^v^>vvv<vv^v<^v>>>^<<>^<<v<vv^^<^>v<vv^v^^v<^>v<^>^v<v<><>v^vv^v^^>^<v>^>v>^>v>^v>v<v<v^vv^>>>v><^vv>vv<^<^^^^><^vv<^vv^<^<^>v<>v<v<v^>^<>^>^<v^^v>>vv>^><vv<>^v>^>^v>>>^vvv><v<><<v<<v^vvv^^<v<>^<^v<>^<<^><v<v^vvv>>^v<><^><<<^^^^^v<><>>^v>v^>^<vv^<v^>^^v^v^^<<^<><>v><<v>^^<<^^^>^>>^<><v<<<v<^>>^>^<v>><<^^vv^>v^^><^><>>vv<><>>>vv<v<vv<^v><>^v<>^v>v<v<>v><v^^<vvv^v<<<>v^v<><>>^vv>^^<v>^<<^^<v>^<^v<^v>>>^<<^v>>^^<>><>><<^<<<vv<>^^^^v<v^^v<<<>^><^>>^<>>v^<>^>>><<^<>><^^>^><<v>>vv^<<v><^v>^<^<>><^^v<<^^^<^v>v>v>>v<<^^^<^^^>^>^<>^^^<^><^^v^^^^<><<v^v^^>vv^<<^<vv<>v>>>^vv>^^><^<><><<^<>>><<v>^><>><<<<^<>vv<^^^>^v^<<<<^<^><<^v^^vv>>^^<^<^<>^vv>v>vv>>>^<v<^^v^^v>v>>v><^<<v>^v>^>^>v>v^>v^v^^^>^<^><vv><<^>>v^<v><<><vvv<vv<<>>>v<v><^<<v<^>^><vvvvv^v<^<v^>^<<v^<<v^<vv>vv^>^><^>v<v<^<v>>>>>^<><<>>^<>^<v>^>v>v>^<><^><>v^v<<<><<^><v<<<vvv>>v<<<^^^v<<><^^<^^v>>>^<vv<^v>>>v>>^^^<^vvvv<^v>^><^v^<^^vv>v>>^^<v^<^^vvv>^^<><<v<v<v<><><vv^>>^<v><<><<><>v^v^<>^^<^^>>^^>v<^vv<<^v<>vv^<>^>vv>vv<v<><^<><vv><<>vvv^^>>>v>^^vvv<>^>>^^v^v<<>>vvv><>^<<^>^^^^<><^^<>v^>^^<v<vv<>v>>>v^<vv<vv>>vv<v^>><>>v>>^v>v<^<^<>>><>>>v<>vv>><v^<<^>v^<<><><<^<>v<<^^>>v>^>v^<^^v><v^^v^<>v<<<>^v^>v<>vvvvv<<>v^>^>^<<<vv<>vv>><v>><^^<>><^^>><>^^^<v><^<<v^>^<^<^vvv>>><vv><^^v>v^<>>^<>><<><<^<v<v^<<<<>^><^>^^v<^<^^<^^^^v>^^>^^vvv^<^^<^vv^^^>>v^>^<>v>>v<><><><<<vv>^v<^<^>><^>v^>v<<v^^v<^^>vv^^v<v>>^<<<^<>>v^>v<v<<^v>>>v>v^v>vv^^vv<<vv^>^vv^>^<vv>^>^^v^<v^v>v<^>v^<^>>^v<vv<^^^><>v<<^<^<v><>>v<v>^>^vv<^>>^^>v^>>v^^>^<<^^v^v<^<>>^v><>>^v<^v^^><v^>^><<<<<>><vv^<^>v>>^<^vvv<<>>vv<^<<><^v>vv>>v><v><v>^v^<^<<<^^v><><^v>^>vv>vv^<^v<^^<<v^v<<><>^>v<^<vvvv^<v>><v^<^^v<vvv^^vv><>^>><><v^^^<<v><>^vvv<>^<v^v<>vv><^^<v><<^v<^<^^v<<v^v<^<^^v^^v^^vv<v>><^^v^>^><^vvv>^^>v<vvvvv>v^>^^^>^v^^><^v>^^<<^^<v^>v<^<^v>v>v^v^v<v^>vvv^>^vv^vvvv>^v>^<<^<v<>^>><<^v^<><><v<<^<<^v><>v<v<vv<>^><v<^>>v<<^><v^v>vv>>><^<>^>>><<>^^>vv^<>^v>v<>>>>^^<^^v><>^>>^v<^^v^<<^^v>>^vv<^<^<>v<^<>v^vvvv><^vv<^v^v>><<^<<><<<<<>v^<v^^<vv^<>v><v<v^<v^<^^>^v<vvv>v<^v<^<^>^<vv>^>>^^^v>><<v>^^><<^v>><vv>v^>><<v^^v^><vv<<v^><<vv>><v^v^<<<<>><>v><<<>v^vvvvv><^vv>>^<<<>>v^v^>v>^^<<>v>v<v<v><>><^>^<v^<<<>>v^<<><^>^^<<>><<v^><<>v<>^<><^v^<<vv<^v<>><v^<>v<v^^><v>^v^>^>><v^>^<<v<<v<<v<v^<<v>><v>^vv<^vv^v><<<>vv<v^>v>^v^<>^<v^>><><^v<^v^<>v^<>>v^><^^>^<vvv<<><^>^>^>>^<v><^^>^^vv^<^v><>^v><v<^<^^<vvv>><><><<vv>^<^v^<vv^^<>><<^^>v^v^^<<^^v<v>^^<^>vv^^>^>^^<<v>>>^^<<v<>^>^<^^vvvv>^v<^v<>v>^>^v^>vvvvv<v<<>v>>><<^vv^v^<<vvvv<^>vv>^<>>>v<>>^^<<<<<v>v<>^v^vv^v^v><<>><>>^<^<v>>^v<v>^^^>^^^v>^v^^^^><<<^<v<<<<^<^v^^<>^>vv<^v>^>>^^^vv>v>>>>v<<>^><^><^<v<>>><v>vv>>v>^<>>^v>^v>>><v>v<>>^v<>^^^^>>^vvvvvv^^v<<<vv^<^<v^v^v>v<><>^v<<>>>vvv><v>vv>^^<<>>^<>^>^^>^^><^<<v<^^^^v^><v<><<>^><><<^v><<^^>^v<v><>>><^^>v^^>^^>^^v<^<>>v>^v^v>>^^vvv>>^^<>^^^v^^<><v<>>v^><>^^v<<^v<<v<>^v^<^<<<<<^^<<vv>>v>^>^><v^<<^v>v<><<><<v^^^v^<^^><^v^v<<^>^<^><v<v<^>^>>>^^^^^>v^<v<v<^v^>^<>v<^<v<^<<><v><^^<v^<>vvv^<<v^>v^^>vv^<^>>^^<^v^^^v<vv>^<>v<^^^>>>vv>^^^<^<<<^<v<<><v<>v>^>^v<<^>>>v>><<^^>vvv<>><>^><^>^<v<<v<<^^>^vvv>><>>v^>^<^<<v<v^>^^>>^>^>>^^<^v<<^>>>^^vv<^<vv<v>^><<v^>v><^v>^^v<^^v^>^><^v<<<<^<><v<>^<v<v><v<><<>>>v<>>>^^^vvvv^v<>^^v^<<<v^>^>>vv<^><^<^<v><^^vvv<v^^v^>>^>vvv>>>^>>>v>v><^>^<<<^^>^^^v<>>^<^>^>v^><>^^v<>^^v><<vvv^>vv>^^<v>^^<<<>>>v^>>^^<><>vv>vvv><<>^vv^^v>>^^^>>>>^<v><<v^^<^^^<>>><<v<^<^>v<<^^^vv^<<vv><>vv^v^>^^>v>v^^>^>v^><>v>v^v^<vv>v><<vv<v><vv>>><>^^v<^><<><<vvv>^<<<<v<^v<><^<>^vv^v>^<>>^v>^<<<><>><><<v<<>>^vv><><>>^^^>^v>v>vv^<<><^^><>><v<><<>v>vv^<v<<^<vvv<^>>><^vv^^^^vv<^vv^v^>>^v^<>>><<>^>>^^><^<^v>><>>><v^>vv>v^v>v^>>vvvv^<^<<vvvv><v><v><v<^v^<><^^v^^<<>^^^v>>v^^<v<>v^<<v><^><<>><<>^<v>^<v<vv><^<<vvv^<^<^^>^<vv^>v>><vv^>v>v^^v^>><<v^^v><vv><v<<<<^^^v<<^>>>^>^<^^^^v><>vv<vvv>v^v>>>>><^>^>>^>v<^v^^<v^v^v^>v^<>v^>v>><<<><<v>v>^^^v^>>^<>v<^^^^v<>><<^^<^<^<<v^><<><><vv>><>^<^v<<^^vvv<^vv>v^vv><^^^<><vv^<<vv^<>>^v<^>^<^^v^v>^v<^<vv^>>^^>v>v^<^>>v>v<>>>^>>>>vvv<<^vvvv>><v><^>v<^>v<>^v^<<<v<v<^vv>>^^^<<^<v^v>v<vv^^v^^<^v>v<<><^^<^>v>v>^^v<v<><>><^>><v^v<<<v<^^^^^^^<<>vv^<vvv^>>v^^><<<v^vv^v<^<vv>^<^>v>>vvv>><^>vv<v^<^^>>>^<<><<<<v>>><^v<<v<^><v^<v><<^vv^>>vv>v^^>v<vv<v^>v<^^^<><^>v><<^<v^v^v^^>vv<v<<v<^v>^^><^<v<<><<<^<<^v^v<v^>v<vv^v^>vv^^>^>vv^v<<<>>vv<^v^<^v^<<v^^>^<>^<>^>><v><^^vv<vvv>>^v<vv<<>v<^<<vvv>vv<vv>>v^^^v<^vvv>>>v<<>><>>^^vv<vv>^vvv^^v>v<<vvv<v>^<v^v^<v>>vvv><v><<^<v>>^<^>^^<v>^<v<^><vv^>v^v>v^^v^v>><v>^><<^^^vv><>^<^^v^>v^v<^><<<<^>>^>>^^^v>v><<><<>>>>><v<><<>v^vv>v<^<^<^><v><<>^^^^<v><v<v><<v<v<^vvv>>><>>^>^<^<^<v^^>v>^<^^^v>><<<v<<vv><>v<<<<^>^v^v^<v<>>^<v>vvv>><<^v><<>^v<^>^<><<<>^<^>^v<v^v<<>^<<^<<<v><^^<>>v<^>>><><^vv<^v^vvvv>>^^<>^<>^<<<<v^><>><vv<^^>>^^v>v>^^^<<vv<>>>><<^><^^^^>v^><^vvv<v>vv<v<<>>>>vv>v<^^>v^^^>v^>><^^<<^^<^<>^<^^v^v<>^<v<<<^v<v>>^^<>><<v><^^>>v<<<<^>^>>><v>^^<<^<v^>^<><>vv>vv<^>v<>>vvv<>vv<^^>vvv^v<v<>^<<vv^^>^>vvvv<<<v<>^>>><<^vv>^v^vv>vv^<vv>>><>v^>^<>v>>v>>^<>>v<^><vv<v<vv<^v<<^><<>v<<<<<>v>>>vv<^<<^<>^<^<>v<><^>v^<<^v>vv><>^v^^^vvv<>^^<<^<>^v^>^>v>^v^^^<<^^^><vv^<<>v^>><v>^<v<><>";

data = strrep(data, '#', '##');
data = strrep(data, 'O', '[]');
data = strrep(data, '.', '..');
data = strrep(data, '@', '@.');

% this function is based on the function "moveUp" in
% https://github.com/dannybres/Advent-of-Code/blob/main/2024/Day%2015/day15puzzle2.m
% but works on a smaller input
function horizon = moveElementsInHorizon(horizon)
    firstEmptyIdx = find(horizon == '.', 1);

    if(~(isempty(firstEmptyIdx)))
        firstWallIdx = find(horizon == '#', 1);

        if(firstEmptyIdx < firstWallIdx)
            horizon(firstEmptyIdx) = [];
            horizon = ['.', horizon];
        end
    end
end

function data = moveRight(data, robotPos)
    [robotPosRow, robotPosCol] = ind2sub(size(data), robotPos);
    horizon = data(robotPosRow, robotPosCol:end);
    horizon = moveElementsInHorizon(horizon);
    data(robotPosRow, robotPosCol:end) = horizon;
end

function data = moveLeft(data, robotPos)
    [robotPosRow, robotPosCol] = ind2sub(size(data), robotPos);
    horizon = data(robotPosRow, 1:robotPosCol);
    horizon = flip(horizon);
    horizon = moveElementsInHorizon(horizon);
    horizon = flip(horizon);
    data(robotPosRow, 1:robotPosCol) = horizon;
end

function horizon = moveHorizonUp(horizon)
    [r,c] = find(horizon == '@');
    q = [r c];
    toMove = [];
    while q
        toMove = [toMove; q(1,:)]; %#ok<*AGROW>
        nr = q(1,1) - 1; nc = q(1,2);
        q(1,:) = [];
        if horizon(nr,nc) == '#', return, end
        if horizon(nr,nc) == '['
            q = [q; nr,nc;nr,nc+1];
        elseif horizon(nr,nc) == ']'
            q = [q; nr,nc;nr,nc-1];
        end
    end
    a = horizon(sub2ind(size(horizon),toMove(:,1),toMove(:,2)));
    horizon(sub2ind(size(horizon),toMove(:,1),toMove(:,2))) = '.';
    horizon(sub2ind(size(horizon),toMove(:,1)-1,toMove(:,2))) = a;
end

function data = moveUp(data, robotPos)
    if(data(robotPos - 1) == '#')
        return;
    end

    if(data(robotPos - 1) == '.')
        data(robotPos - 1) = '@';
        data(robotPos) = '.';
        return;
    end

    [robotPosRow, robotPosCol] = ind2sub(size(data), robotPos);
    horizonExtensionLeft = 0;
    horizonExtensionRight = 0;
    horizon = data(1:robotPosRow, (robotPosCol - horizonExtensionLeft):(robotPosCol + horizonExtensionRight));

    while(true)
        leftmostColumn = horizon(1:end-1, 1);

        if(any(leftmostColumn == "]"))
            horizonExtensionLeft++;
            horizon = data(1:robotPosRow, (robotPosCol - horizonExtensionLeft):(robotPosCol + horizonExtensionRight));
        else
            break;
        end
    end

    while(true)
        rightmostColumn = horizon(1:end-1, end);

        if(any(rightmostColumn == "["))
            horizonExtensionRight++;
            horizon = data(1:robotPosRow, (robotPosCol - horizonExtensionLeft):(robotPosCol + horizonExtensionRight));
        else
            break;
        end
    end

    horizon = moveHorizonUp(horizon);

    % data(robotPos - 1) = '@';
    % data(robotPos) = '.';
    data(1:robotPosRow, (robotPosCol - horizonExtensionLeft):(robotPosCol + horizonExtensionRight)) = horizon;
end

function data = moveDown(data, robotPos)
    data = flip(data);
    robotPos = find(data == '@');
    data = moveUp(data, robotPos);
    data = flip(data);
end

for ii = 1:numel(moves)
    % moves(ii)
    robotPos = find(data == '@');

    if(moves(ii) == '>')
        data = moveRight(data, robotPos);
    end

    if(moves(ii) == '<')
        data = moveLeft(data, robotPos);
    end

    if(moves(ii) == '^')
        data = moveUp(data, robotPos);
    end

    if(moves(ii) == 'v')
        data = moveDown(data, robotPos);
    end

    % pause(2)
    % data
end

function result = computeGps(data, boxPos)
    [boxPosRow, boxPosCol] = ind2sub(size(data), boxPos);
    result = boxPosCol - 1 + 100*(boxPosRow - 1);
end

boxPos = find(data == '[');
sum2 = 0;

for ii = 1:numel(boxPos)
    sum2+=computeGps(data, boxPos(ii));
end

sum2
% assert(1463160 == sum2);
